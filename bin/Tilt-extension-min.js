'use strict';var TiltChrome=TiltChrome||{},EXPORTED_SYMBOLS=["TiltChrome.BrowserOverlay"];
TiltChrome.BrowserOverlay={href:null,canvas:null,visualization:null,sourceEditor:null,colorPicker:null,initialize:function(){this.destroy(!0);if(this.href===window.content.location.href)this.href=null;else{this.href=window.content.location.href;this.sourceEditor={panel:document.getElementById("tilt-sourceeditor"),title:document.getElementById("tilt-sourceeditor-title"),iframe:document.getElementById("tilt-sourceeditor-iframe")};this.colorPicker={panel:document.getElementById("tilt-colorpicker"),iframe:document.getElementById("tilt-colorpicker-iframe")};
this.sourceEditor.refresh=this.sourceEditor.iframe.contentWindow.refreshCodeEditor;this.colorPicker.refresh=this.colorPicker.iframe.contentWindow.refreshColorPicker;gBrowser.selectedBrowser.markupDocumentViewer.fullZoom=1;var a=document.getElementById("tilt-iframe"),b=window.content.innerWidth,c=window.content.innerHeight;Tilt.Document.currentContentDocument=a.contentDocument;Tilt.Document.currentParentNode=gBrowser.selectedBrowser.parentNode;this.canvas=Tilt.Document.initCanvas(b,c,!0);this.visualization=
new TiltChrome.Visualization(this.canvas,new TiltChrome.Controller.MouseAndKeyboard,new TiltChrome.UI.Default)}},destroy:function(a,b){Tilt.Document.currentContentDocument=null;Tilt.Document.currentParentNode=null;if(this.canvas!==null)this.canvas.parentNode.removeChild(this.canvas),this.canvas=null;var c=function(){if(this.visualization!==null)this.visualization.destroy(),this.visualization=null;if(this.sourceEditor!==null)this.sourceEditor.panel.hidePopup(),this.sourceEditor.panel=null,this.sourceEditor.title=
null,this.sourceEditor=this.sourceEditor.iframe=null;if(this.colorPicker!==null)this.colorPicker.panel.hidePopup(),this.colorPicker.panel=null,this.colorPicker=this.colorPicker.iframe=null;Tilt.Profiler.log();Tilt.Profiler.reset();a&&window.setTimeout(function(){this.performGC()}.bind(this),100)}.bind(this);b?window.setTimeout(function(){c()},100):c()},performGC:function(){window.QueryInterface(Ci.nsIInterfaceRequestor).getInterface(Ci.nsIDOMWindowUtils).garbageCollect()}};
var Tilt=Tilt||{},EXPORTED_SYMBOLS=["Tilt.Arcball"];
Tilt.Arcball=function(a,b,c,d,f){Tilt.Profiler.intercept("Tilt.Arcball",this);this.$mousePress=[0,0];this.$mouseRelease=[0,0];this.$mouseMove=[0,0];this.$mouseLerp=[0,0];this.$mouseButton=-1;this.$scrollValue=0;this.$scrollSpeed=1;this.$scrollMin=-3E3;this.$scrollMax=500;this.$keyCode=[];this.$startVec=vec3.create();this.$endVec=vec3.create();this.$pVec=vec3.create();this.$lastRot=quat4.create([0,0,0,1]);this.$deltaRot=quat4.create([0,0,0,1]);this.$currentRot=quat4.create([0,0,0,1]);this.$lastTrans=
vec3.create();this.$deltaTrans=vec3.create();this.$currentTrans=vec3.create();this.$addKeyRot=f||[0,0];this.$addKeyTrans=d||[0,0];this.$deltaKeyRot=quat4.create([0,0,0,1]);this.$deltaKeyTrans=vec3.create();this.resize(a,b,c)};
Tilt.Arcball.prototype={loop:function(a){var a=Tilt.Math.clamp((a||25)*0.01,0.01,0.99),b,c,d=this.$radius,f=this.$width,g=this.$height,h=this.$mousePress,i=this.$mouseRelease,k=this.$mouseMove;c=this.$mouseLerp;var l=this.$mouseButton,m=this.$scrollValue,j=this.$keyCode,q=this.$startVec,t=this.$endVec,s=this.$pVec,x=this.$lastRot,r=this.$deltaRot,o=this.$currentRot,w=this.$lastTrans,u=this.$deltaTrans,v=this.$currentTrans,y=this.$addKeyRot,A=this.$addKeyTrans,n=this.$deltaKeyRot,B=this.$deltaKeyTrans;
c[0]+=(k[0]-c[0])*a;c[1]+=(k[1]-c[1])*a;b=c[0];c=c[1];if(l===3||b===i[0]&&c===i[1])this.$rotating=!1;l===1||this.$rotating?(this.$rotating=!0,this.pointToSphere(b,c,f,g,d,t),vec3.cross(q,t,s),vec3.length(s)>0?(r[0]=s[0],r[1]=s[1],r[2]=s[2],r[3]=-vec3.dot(q,t)):(r[0]=0,r[1]=0,r[2]=0,r[3]=1),quat4.multiply(x,r,o)):quat4.set(o,x);l===3?(u[0]=k[0]-h[0],u[1]=k[1]-h[1],v[0]=w[0]+u[0],v[1]=w[1]+u[1]):(w[0]=v[0],w[1]=v[1]);u[2]=(m-v[2])*0.1;v[2]+=u[2];j[65]&&(y[0]-=a*0.2);j[68]&&(y[0]+=a*0.2);j[87]&&(y[1]+=
a*0.2);j[83]&&(y[1]-=a*0.2);j[37]&&(A[0]+=a*50);j[39]&&(A[0]-=a*50);j[38]&&(A[1]+=a*50);j[40]&&(A[1]-=a*50);n[0]+=(y[0]-n[0])*a;n[1]+=(y[1]-n[1])*a;B[0]+=(A[0]-B[0])*a;B[1]+=(A[1]-B[1])*a;Tilt.Math.quat4fromEuler(n[0],n[1],0,r);u[0]=B[0];u[1]=B[1];u[2]=0;return{rotation:quat4.multiply(r,o),translation:vec3.add(u,v)}},mouseDown:function(a,b,c){this.$clearInterval();this.$mousePress[0]=a;this.$mousePress[1]=b;this.$mouseButton=c;this.$save();this.pointToSphere(a,b,this.$width,this.$height,this.$radius,
this.$startVec);quat4.set(this.$currentRot,this.$lastRot)},mouseUp:function(a,b){this.$mouseRelease[0]=a;this.$mouseRelease[1]=b;this.$mouseButton=-1},mouseMove:function(a,b){this.$mouseButton!==-1&&(this.$mouseMove[0]=a,this.$mouseMove[1]=b)},mouseOver:function(){this.$mouseButton=-1},mouseOut:function(){this.$mouseButton=-1},mouseScroll:function(a){var b=this.$scrollSpeed,c=this.$scrollMin,d=this.$scrollMax;this.$clearInterval();this.$scrollValue=Tilt.Math.clamp(this.$scrollValue-a*b,c,d)},keyDown:function(a){this.$clearInterval();
this.$keyCode[a]=!0},keyUp:function(a){this.$keyCode[a]=!1},pointToSphere:function(a,b,c,d,f,g){a=(a-c*0.5)/f;b=(b-d*0.5)/f;c=0;c=a*a+b*b;c>1?(c=1/Math.sqrt(c),g[0]=a*c,g[1]=b*c,g[2]=0):(g[0]=a,g[1]=b,g[2]=Math.sqrt(1-c))},setScrollBounds:function(a,b){this.$scrollMin=a;this.$scrollMax=b},setScrollSpeed:function(a){this.$scrollSpeed=a},translate:function(a,b){this.$addKeyTrans[0]+=a;this.$addKeyTrans[1]+=b},rotate:function(a,b){this.$addKeyRot[0]+=a;this.$addKeyRot[1]+=b},zoom:function(a){this.$scrollValue+=
a},stop:function(){this.$clearInterval();this.$save();this.$mouseButton=-1},resize:function(a,b,c){this.$width=a;this.$height=b;this.$radius=c?c:b;this.$save()},reset:function(a){var b=this.$scrollValue,c=this.$lastRot,d=this.$deltaRot,f=this.$currentRot,g=this.$lastTrans,h=this.$deltaTrans,i=this.$currentTrans,k=this.$addKeyRot,l=this.$addKeyTrans,m=quat4.inverse,j=quat4.slerp,q=vec3.scale,t=vec3.length;this.$setInterval(function(){var s=m(c);j(c,s,1-a);j(d,s,1-a);j(f,s,1-a);q(g,a);q(h,a);q(i,a);
k[0]*=a;k[1]*=a;l[0]*=a;l[1]*=a;this.$scrollValue*=a;t(c)<1.0E-4&&t(d)<1.0E-4&&t(f)<1.0E-4&&t(g)<0.01&&t(h)<0.01&&t(i)<0.01&&t([k[0],k[1],b])<0.01&&t([l[0],l[1],b])<0.01&&this.$clearInterval()}.bind(this),1E3/60)},$setInterval:function(a,b){if("undefined"===typeof this.$currentInterval)this.$currentInterval=window.setInterval(a,b)},$clearInterval:function(){"undefined"!==typeof this.$currentInterval&&(window.clearInterval(this.$currentInterval),delete this.$currentInterval)},$save:function(){var a=
this.$mouseMove,b=this.$mouseRelease,c=this.$mouseLerp,d=this.$mousePress[0],f=this.$mousePress[1];a[0]=d;a[1]=f;b[0]=d;b[1]=f;c[0]=d;c[1]=f},destroy:function(){this.stop();Tilt.destroyObject(this)}};Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.VertexBuffer","Tilt.IndexBuffer"];Tilt.VertexBuffer=function(a,b,c){Tilt.Profiler.intercept("Tilt.VertexBuffer",this);this.components=this.$ref=null;this.numItems=this.itemSize=0;"undefined"!==typeof a&&this.initBuffer(a,b,c)};
Tilt.VertexBuffer.prototype={initBuffer:function(a,b,c){var d=Tilt.$gl;"undefined"===typeof c&&(c=a.length/b);this.components=new Float32Array(a);this.$ref=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,this.$ref);d.bufferData(d.ARRAY_BUFFER,this.components,d.STATIC_DRAW);this.itemSize=b;this.numItems=c},destroy:function(){try{Tilt.$gl.deleteBuffer(this.$ref)}catch(a){}Tilt.destroyObject(this)}};
Tilt.IndexBuffer=function(a,b){Tilt.Profiler.intercept("Tilt.IndexBuffer",this);this.components=this.$ref=null;this.numItems=this.itemSize=0;"undefined"!==typeof a&&this.initBuffer(a,b)};
Tilt.IndexBuffer.prototype={initBuffer:function(a,b){var c=Tilt.$gl;if("undefined"===typeof b)b=a.length;this.components=new Uint16Array(a);this.$ref=c.createBuffer();c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.$ref);c.bufferData(c.ELEMENT_ARRAY_BUFFER,this.components,c.STATIC_DRAW);this.itemSize=1;this.numItems=b},destroy:function(){try{Tilt.$gl.deleteBuffer(this.$ref)}catch(a){}Tilt.destroyObject(this)}};Tilt=Tilt||{};EXPORTED_SYMBOLS="Tilt.$gl,Tilt.$renderer,Tilt.$activeShader,Tilt.$enabledAttributes,Tilt.$loadedTextures,Tilt.clearCache".split(",");
Tilt.$gl=null;Tilt.$renderer=null;Tilt.$activeShader=-1;Tilt.$enabledAttributes=-1;Tilt.$loadedTextures={};Tilt.clearCache=function(){Tilt.destroyObject(Tilt.$gl);Tilt.destroyObject(Tilt.$renderer);Tilt.destroyObject(Tilt.$activeShader);Tilt.destroyObject(Tilt.$enabledAttributes);Tilt.destroyObject(Tilt.$loadedTextures);Tilt.$gl=null;Tilt.$renderer=null;Tilt.$activeShader=-1;Tilt.$enabledAttributes=-1;Tilt.$loadedTextures={};Tilt.GLSL.$count=0;Tilt.TextureUtils.$count=0};Tilt=Tilt||{};
EXPORTED_SYMBOLS=["Tilt.destroyObject","Tilt.bindObjectFunc"];Tilt.destroyObject=function(a){for(var b in a)try{"function"===typeof a[b].destroy&&a[b].destroy()}catch(c){}finally{try{a[b]=null,delete a[b]}catch(d){}}};Tilt.bindObjectFunc=function(a,b){for(var c in a)try{"function"===typeof a[c]&&(a[c]=a[c].bind(b||a))}catch(d){}};Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.Profiler"];
Tilt.Profiler={enabled:!1,functions:[],intercept:function(a,b,c,d,f,g){if(this.enabled){var h,i,k;if(c){if("undefined"===typeof d&&(d=this.beforeCall.bind(this)),"undefined"===typeof f&&(f=this.afterCall.bind(this)),"undefined"===typeof g&&(g=this.duringCall.bind(this)),h=b[c],"function"===typeof h)i=this.functions.length,this.functions[i]={name:(a+"."||"")+c,calls:0,averageTime:0,longestTime:0,totalTime:0},b[c]=function(){try{return d(i),g(b,h,arguments)}finally{f(i)}}}else for(k in b)"function"===
typeof b[k]&&this.intercept(a,b,k,d,f,g)}},beforeCall:function(a){if("undefined"!==typeof this.functions[a])this.functions[a].currentTime=(new Date).getTime()},afterCall:function(a){a=this.functions[a];if("undefined"!==typeof a){var b=a.currentTime,b=(new Date).getTime()-b;a.calls++;a.longestTime=Math.max(a.longestTime,b);a.averageTime=(a.longestTime+b)*0.5;a.totalTime+=b}},duringCall:function(a,b,c){return c.length===0?b.call(a):b.apply(a,c)},log:function(){var a=this.functions.slice(0),b,c,d,f;
a.sort(function(a,b){return a.totalTime<b.totalTime?1:-1});for(b=0;b<a.length;b++){d=a[b];for(c=b+1;c<a.length;c++)if(f=a[c],d.name===f.name)d.calls+=f.calls,d.longestTime=Math.max(d.longestTime,f.longestTime),d.averageTime=(d.averageTime+f.averageTime)*0.5,d.totalTime+=f.totalTime,a.splice(c,1),c--;d.calls!==0&&Tilt.Console.log("function "+d.name+"\ncalls    "+d.calls+"\naverage  "+d.averageTime+"ms\nlongest  "+d.longestTime+"ms\ntotal    "+d.totalTime+"ms")}},reset:function(){this.functions=[]}};
Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.Program"];Tilt.Program=function(a,b){Tilt.Profiler.intercept("Tilt.Program",this);this.$ref=null;this.$id=-1;this.$uniforms=this.$attributes=null;this.$cache={};this.$texcache={};arguments.length===2&&this.initProgram(a,b)};
Tilt.Program.prototype={initProgram:function(a,b){this.$ref=Tilt.GLSL.create(a,b);this.$id=this.$ref.id;this.$attributes=this.$ref.attributes;this.$uniforms=this.$ref.uniforms;this.$ref.id=null;this.$ref.attributes=null;this.$ref.uniforms=null;delete this.$ref.id;delete this.$ref.attributes;delete this.$ref.uniforms},initProgramAt:function(a,b,c){arguments.length===2&&(c=b,b=a+".fs",a+=".vs");Tilt.Xhr.requests([a,b],function(a){this.initProgram(a[0].responseText,a[1].responseText);"function"===typeof c&&
c()}.bind(this))},use:function(){var a=this.$id,b;if(Tilt.$activeShader!==a&&(Tilt.$activeShader=a,a=Tilt.$gl,a.useProgram(this.$ref),this.clearTextureCache(),Tilt.$enabledAttributes<this.$attributes.length))for(b in Tilt.$enabledAttributes=this.$attributes.length,this.$attributes)this.$attributes.hasOwnProperty(b)&&b!=="length"&&a.enableVertexAttribArray(this.$attributes[b])},bindVertexBuffer:function(a,b){var c=Tilt.$gl,d=this.$attributes[a],f=b.itemSize;c.bindBuffer(c.ARRAY_BUFFER,b.$ref);c.vertexAttribPointer(d,
f,c.FLOAT,!1,0,0)},bindUniformMatrix:function(a,b){var c=this.$cache,d=(b[0]+b[1]+b[2])*(b[4]+b[5]+b[6])*(b[8]+b[9]+b[10])*(b[12]+b[13]+b[14]);c[a]!==d&&(c[a]=d,Tilt.$gl.uniformMatrix4fv(this.$uniforms[a],!1,b))},bindUniformVec4:function(a,b){var c=this.$cache,d=b[3]*255<<24|b[0]*255<<16|b[1]*255<<8|b[2]*255;c[a]!==d&&(c[a]=d,Tilt.$gl.uniform4fv(this.$uniforms[a],b))},bindUniformFloat:function(a,b){var c=this.$cache;c[a]!==b&&(c[a]=b,Tilt.$gl.uniform1f(this.$uniforms[a],b))},bindTexture:function(a,
b){var c=this.$texcache,d=b.$id;if(c[a]!==d)c[a]=d,c=Tilt.$gl,c.bindTexture(c.TEXTURE_2D,b.$ref),c.uniform1i(this.$uniforms[a],0)},clearTextureCache:function(){this.$texcache={}},clearCache:function(){this.$cache={}},destroy:function(){try{Tilt.$gl.deleteShader(this.$ref)}catch(a){}Tilt.destroyObject(this)}};Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.GLSL"];
Tilt.GLSL={create:function(a,b){var c=this.compile(a,"x-shader/x-vertex"),d=this.compile(b,"x-shader/x-fragment");return this.link(c,d)},compile:function(a,b){var c=Tilt.$gl,d;if("string"!==typeof a||a.length<1)return Tilt.Console.error(Tilt.StringBundle.get("compileShader.source.error")),null;if(b==="x-shader/x-vertex")d=c.createShader(c.VERTEX_SHADER);else if(b==="x-shader/x-fragment")d=c.createShader(c.FRAGMENT_SHADER);else return Tilt.Console.error(Tilt.StringBundle.format("compileShader.type.error"),
[a]),null;c.shaderSource(d,a);c.compileShader(d);d.src=a;return!c.getShaderParameter(d,c.COMPILE_STATUS)?(c=c.getShaderInfoLog(d),Tilt.Console.error(Tilt.StringBundle.format("compileShader.compile.error"),[c]),null):d},link:function(a,b){var c=Tilt.$gl,d;d=c.createProgram();c.attachShader(d,a);c.attachShader(d,b);c.linkProgram(d);if(!c.getProgramParameter(d,c.LINK_STATUS))return d=c.getProgramInfoLog(d),Tilt.Console.error(Tilt.StringBundle.format("linkProgram.error",[d])),null;d.id=this.$count++;
c=[a.src,b.src].join(" ").replace(/#.*|[(){};,]/g," ").split(" ");return this.shaderIOCache(d,c)},shaderAttribute:function(a,b){return Tilt.$gl.getAttribLocation(a,b)},shaderUniform:function(a,b){return Tilt.$gl.getUniformLocation(a,b)},shaderIO:function(a,b){if("string"===typeof b){if(b.length<1)return null;var c;return(c=this.shaderAttribute(a,b))>=0?c:this.shaderUniform(a,b)}return null},shaderIOCache:function(a,b){var c,d,f,g;a.attributes={};a.attributes.length=0;a.uniforms={};a.uniforms.length=
0;for(c=0,d=b.length;c<d;c++)f=b[c],g=this.shaderIO(a,f),"number"===typeof g&&"undefined"===typeof a.attributes[f]&&(a.attributes[f]=g,a.attributes.length++),"object"===typeof g&&g instanceof WebGLUniformLocation&&"undefined"===typeof a.uniforms[f]&&(a.uniforms[f]=g,a.uniforms.length++);return a},$count:0};Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.Texture"];
Tilt.Texture=function(a,b){Tilt.Profiler.intercept("Tilt.Texture",this);b=b||{};this.$ref=null;this.height=this.width=this.$id=-1;this.loaded=!1;this.onload=b.onload;"object"===typeof a?this.initTexture(a,b):"string"===typeof a?this.initTextureAt(a,b):Tilt.Console.error(Tilt.StringBundle.get("initTexture.source.error"))};
Tilt.Texture.prototype={initTexture:function(a,b){this.$ref=Tilt.TextureUtils.create(a,b);if("undefined"!==typeof this.$ref&&this.$ref!==null){this.$id=this.$ref.id;this.width=this.$ref.width;this.height=this.$ref.height;this.loaded=!0;if("function"===typeof this.onload)this.onload();this.$ref.id=null;this.$ref.width=null;this.$ref.height=null;delete this.$ref.id;delete this.$ref.width;delete this.$ref.height}this.onload=null;delete this.onload},initTextureAt:function(a,b){var c=new Image;c.src=a;
c.onload=function(){this.initTexture(c,b);b=c=null}.bind(this)},updateSubImage2D:function(a,b,c){this.width===a.width&&this.height===a.height&&b&&c&&(c=b=0);var d=Tilt.$gl;d.bindTexture(d.TEXTURE_2D,this.$ref);d.texSubImage2D(d.TEXTURE_2D,0,b,c,d.RGBA,d.UNSIGNED_BYTE,a)},destroy:function(){try{Tilt.$gl.deleteTexture(this.$ref)}catch(a){}Tilt.destroyObject(this)}};Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.TextureUtils"];
Tilt.TextureUtils={create:function(a,b){if(!("undefined"===typeof a||a===null)){b=b||{};if("undefined"!==typeof Tilt.$loadedTextures[a.src])return Tilt.$loadedTextures[a.src];var c=Tilt.$gl,d=Tilt.TextureUtils.resizeImageToPowerOfTwo(a,b),f=c.getParameter(c.TEXTURE_BINDING_2D),g=a.width,h=a.height,i=c.createTexture();c.bindTexture(c.TEXTURE_2D,i);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,d);i.width=g;i.height=h;i.id=this.$count++;this.setTextureParams(b);c.bindTexture(c.TEXTURE_2D,
f);"undefined"!==typeof a.src&&(Tilt.$loadedTextures[a.src]=i);return i}},setTextureParams:function(a){var b=Tilt.$gl,c=b.TEXTURE_MIN_FILTER,d=b.TEXTURE_MAG_FILTER,f=b.TEXTURE_WRAP_S,g=b.TEXTURE_WRAP_T,a=a||{};a.texture&&b.bindTexture(b.TEXTURE_2D,a.texture.ref);"nearest"===a.minFilter?b.texParameteri(b.TEXTURE_2D,c,b.NEAREST):"linear"===a.minFilter&&a.mipmap?b.texParameteri(b.TEXTURE_2D,c,b.LINEAR_MIPMAP_LINEAR):b.texParameteri(b.TEXTURE_2D,c,b.LINEAR);"nearest"===a.magFilter?b.texParameteri(b.TEXTURE_2D,
d,b.NEAREST):"linear"===a.magFilter&&a.mipmap?b.texParameteri(b.TEXTURE_2D,d,b.LINEAR_MIPMAP_LINEAR):b.texParameteri(b.TEXTURE_2D,d,b.LINEAR);"repeat"===a.wrapS?b.texParameteri(b.TEXTURE_2D,f,b.REPEAT):b.texParameteri(b.TEXTURE_2D,f,b.CLAMP_TO_EDGE);"repeat"===a.wrapT?b.texParameteri(b.TEXTURE_2D,g,b.REPEAT):b.texParameteri(b.TEXTURE_2D,g,b.CLAMP_TO_EDGE);a.mipmap&&b.generateMipmap(b.TEXTURE_2D)},resizeImageToPowerOfTwo:function(a,b){var b=b||{},c=(a.src||"").indexOf("chrome://"),d=Tilt.Math.isPowerOfTwo(a.width),
f=Tilt.Math.isPowerOfTwo(a.height);if(b.preserve||d&&f&&c===-1)try{return a}finally{b=a=null}c=Tilt.Math.nextPowerOfTwo(a.width);d=Tilt.Math.nextPowerOfTwo(a.height);c=Tilt.Document.initCanvas(c,d);d=c.getContext("2d");if(b.fill)d.fillStyle=b.fill,d.fillRect(0,0,c.width,c.height);d.drawImage(a,0,0,a.width,a.height,0,0,c.width,c.height);if(b.stroke)d.strokeStyle=b.stroke,d.lineWidth=b.strokeWeight,d.strokeRect(0,0,c.width,c.height);return c},setTextureFlipY:function(a){Tilt.$gl.pixelStorei(Tilt.$gl.UNPACK_FLIP_Y_WEBGL,
a)},$count:0};
function style_html(a,b){var c,d,f,g,b=b||{};d=b.indent_size||2;f=b.indent_char||" ";g=b.brace_style||"collapse";c=new function(){this.pos=0;this.token="";this.current_mode="CONTENT";this.tags={parent:"parent1",parentcount:1,parent1:""};this.token_text=this.last_token=this.last_text=this.token_type=this.tag_type="";this.Utils={whitespace:"\n\r\t ".split(""),single_token:"br,input,link,meta,!doctype,basefont,base,area,hr,wbr,param,img,isindex,?xml,embed".split(","),extra_liners:"head,body,/html".split(","),in_array:function(a,
b){for(var c=0;c<b.length;c++)if(a===b[c])return!0;return!1}};this.get_content=function(){for(var a="",b=[],c=!1;this.input.charAt(this.pos)!=="<";){if(this.pos>=this.input.length)return b.length?b.join(""):["","TK_EOF"];a=this.input.charAt(this.pos);this.pos++;this.line_char_count++;if(this.Utils.in_array(a,this.Utils.whitespace))b.length&&(c=!0),this.line_char_count--;else{if(c){if(this.line_char_count>=this.max_char){b.push("\n");for(c=0;c<this.indent_level;c++)b.push(this.indent_string);this.line_char_count=
0}else b.push(" "),this.line_char_count++;c=!1}b.push(a)}}return b.length?b.join(""):""};this.get_script=function(){var a="",b=[],a=/<\/script>/igm;a.lastIndex=this.pos;for(var c=(a=a.exec(this.input))?a.index:this.input.length;this.pos<c;){if(this.pos>=this.input.length)return b.length?b.join(""):["","TK_EOF"];a=this.input.charAt(this.pos);this.pos++;b.push(a)}return b.length?b.join(""):""};this.record_tag=function(a){this.tags[a+"count"]?this.tags[a+"count"]++:this.tags[a+"count"]=1;this.tags[a+
this.tags[a+"count"]]=this.indent_level;this.tags[a+this.tags[a+"count"]+"parent"]=this.tags.parent;this.tags.parent=a+this.tags[a+"count"]};this.retrieve_tag=function(a){if(this.tags[a+"count"]){for(var b=this.tags.parent;b;){if(a+this.tags[a+"count"]===b)break;b=this.tags[b+"parent"]}if(b)this.indent_level=this.tags[a+this.tags[a+"count"]],this.tags.parent=this.tags[b+"parent"];delete this.tags[a+this.tags[a+"count"]+"parent"];delete this.tags[a+this.tags[a+"count"]];this.tags[a+"count"]==1?delete this.tags[a+
"count"]:this.tags[a+"count"]--}};this.get_tag=function(){var a="",b=[],c=!1;do{if(this.pos>=this.input.length)return b.length?b.join(""):["","TK_EOF"];a=this.input.charAt(this.pos);this.pos++;this.line_char_count++;if(this.Utils.in_array(a,this.Utils.whitespace))c=!0,this.line_char_count--;else{if(a==="'"||a==='"')if(!b[1]||b[1]!=="!")a+=this.get_unformatted(a),c=!0;a==="="&&(c=!1);if(b.length&&b[b.length-1]!=="="&&a!==">"&&c)this.line_char_count>=this.max_char?(this.print_newline(!1,b),this.line_char_count=
0):(b.push(" "),this.line_char_count++),c=!1;b.push(a)}}while(a!==">");a=b.join("");c=a.indexOf(" ")!=-1?a.indexOf(" "):a.indexOf(">");c=a.substring(1,c).toLowerCase();a.charAt(a.length-2)==="/"||this.Utils.in_array(c,this.Utils.single_token)?this.tag_type="SINGLE":c==="script"?(this.record_tag(c),this.tag_type="SCRIPT"):c==="style"?(this.record_tag(c),this.tag_type="STYLE"):c==="a"?(a=this.get_unformatted("</a>",a),b.push(a),this.tag_type="SINGLE"):c.charAt(0)==="!"?c.indexOf("[if")!=-1?(a.indexOf("!IE")!=
-1&&(a=this.get_unformatted("--\>",a),b.push(a)),this.tag_type="START"):c.indexOf("[endif")!=-1?(this.tag_type="END",this.unindent()):(a=c.indexOf("[cdata[")!=-1?this.get_unformatted("]]\>",a):this.get_unformatted("--\>",a),b.push(a),this.tag_type="SINGLE"):(c.charAt(0)==="/"?(this.retrieve_tag(c.substring(1)),this.tag_type="END"):(this.record_tag(c),this.tag_type="START"),this.Utils.in_array(c,this.Utils.extra_liners)&&this.print_newline(!0,this.output));return b.join("")};this.get_unformatted=function(a,
b){if(b&&b.indexOf(a)!=-1)return"";var c="",d="",f=!0;do{if(this.pos>=this.input.length)break;c=this.input.charAt(this.pos);this.pos++;if(this.Utils.in_array(c,this.Utils.whitespace)){if(!f){this.line_char_count--;continue}if(c==="\n"||c==="\r"){d+="\n";for(c=0;c<this.indent_level;c++)d+=this.indent_string;f=!1;this.line_char_count=0;continue}}d+=c;this.line_char_count++;f=!0}while(d.indexOf(a)==-1);return d};this.get_token=function(){var a;if(this.last_token==="TK_TAG_SCRIPT"){a=this.get_script();
if(typeof a!=="string")return a;a=js_beautify(a,{indent_size:this.indent_size,indent_char:this.indent_character,indent_level:this.indent_level,brace_style:this.brace_style});return[a.replace(/^[\t ]+/,""),"TK_CONTENT"]}if(this.current_mode==="CONTENT")return a=this.get_content(),typeof a!=="string"?a:[a,"TK_CONTENT"];if(this.current_mode==="TAG")return a=this.get_tag(),typeof a!=="string"?a:[a,"TK_TAG_"+this.tag_type]};this.printer=function(a,b,c,d,f){this.input=a||"";this.output=[];this.indent_character=
b;this.indent_string="";this.indent_size=c;this.brace_style=f;this.indent_level=0;this.max_char=d;for(a=this.line_char_count=0;a<this.indent_size;a++)this.indent_string+=this.indent_character;this.print_newline=function(a,b){this.line_char_count=0;if(b&&b.length){if(!a)for(;this.Utils.in_array(b[b.length-1],this.Utils.whitespace);)b.pop();b.push("\n");for(var c=0;c<this.indent_level;c++)b.push(this.indent_string)}};this.print_token=function(a){this.output.push(a)};this.indent=function(){this.indent_level++};
this.unindent=function(){this.indent_level>0&&this.indent_level--}};return this};for(c.printer(a,f,d,80,g);;){d=c.get_token();c.token_text=d[0];c.token_type=d[1];if(c.token_type==="TK_EOF")break;switch(c.token_type){case "TK_TAG_START":case "TK_TAG_SCRIPT":case "TK_TAG_STYLE":c.print_newline(!1,c.output);c.print_token(c.token_text);c.indent();c.current_mode="CONTENT";break;case "TK_TAG_END":c.print_newline(!0,c.output);c.print_token(c.token_text);c.current_mode="CONTENT";break;case "TK_TAG_SINGLE":c.print_newline(!1,
c.output);c.print_token(c.token_text);c.current_mode="CONTENT";break;case "TK_CONTENT":c.token_text!==""&&(c.print_newline(!1,c.output),c.print_token(c.token_text)),c.current_mode="TAG"}c.last_token=c.token_type;c.last_text=c.token_text}return c.output.join("")}
function js_beautify(a,b){function c(a){for(a=typeof a==="undefined"?!1:a;o.length&&(o[o.length-1]===" "||o[o.length-1]===D||o[o.length-1]===T||a&&(o[o.length-1]==="\n"||o[o.length-1]==="\r"));)o.pop()}function d(a){return a.replace(/^\s\s*|\s\s*$/,"")}function f(){var a=K;K=!1;g();K=a}function g(a){n.eat_next_space=!1;if(!K||!m(n.mode))if(a=typeof a==="undefined"?!0:a,n.if_line=!1,c(),o.length){if(o[o.length-1]!=="\n"||!a)N=!0,o.push("\n");T&&o.push(T);for(a=0;a<n.indentation_level;a+=1)o.push(D);
n.var_line&&n.var_line_reindented&&(U===" "?o.push("    "):o.push(D))}}function h(){if(n.eat_next_space)n.eat_next_space=!1;else{var a=" ";o.length&&(a=o[o.length-1]);a!==" "&&a!=="\n"&&a!==D&&o.push(" ")}}function i(){N=!1;n.eat_next_space=!1;o.push(w)}function k(){o.length&&o[o.length-1]===D&&o.pop()}function l(a){n&&B.push(n);n={previous_mode:n?n.mode:"BLOCK",mode:a,var_line:!1,var_line_tainted:!1,var_line_reindented:!1,in_html_comment:!1,if_line:!1,in_case:!1,eat_next_space:!1,indentation_baseline:-1,
indentation_level:n?n.indentation_level+(n.var_line&&n.var_line_reindented?1:0):0,ternary_depth:0}}function m(a){return a==="[EXPRESSION]"||a==="[INDENTED-EXPRESSION]"}function j(a){return a==="[EXPRESSION]"||a==="[INDENTED-EXPRESSION]"||a==="(EXPRESSION)"}function q(){O=n.mode==="DO_BLOCK";B.length>0&&(n=B.pop())}function t(a,b){for(var c=0;c<a.length;c++)if(d(a[c])[0]!=b)return!1;return!0}function s(a,b){for(var c=0;c<b.length;c+=1)if(b[c]===a)return!0;return!1}function x(){L=0;if(p>=E)return["",
"TK_EOF"];Q=!1;var a=r.charAt(p);p+=1;if(K&&m(n.mode)){for(var b=0;s(a,F);){a==="\n"?(c(),o.push("\n"),N=!0,b=0):a==="\t"?b+=4:a!=="\r"&&(b+=1);if(p>=E)return["","TK_EOF"];a=r.charAt(p);p+=1}if(n.indentation_baseline===-1)n.indentation_baseline=b;if(N){var f;for(f=0;f<n.indentation_level+1;f+=1)o.push(D);if(n.indentation_baseline!==-1)for(f=0;f<b-n.indentation_baseline;f++)o.push(" ")}}else{for(;s(a,F);){a==="\n"&&(L+=$?L<=$?1:0:1);if(p>=E)return["","TK_EOF"];a=r.charAt(p);p+=1}if(V&&L>1)for(f=0;f<
L;f+=1)g(f===0),N=!0;Q=L>0}if(s(a,G)){if(p<E)for(;s(r.charAt(p),G);)if(a+=r.charAt(p),p+=1,p===E)break;if(p!==E&&a.match(/^[0-9]+[Ee]$/)&&(r.charAt(p)==="-"||r.charAt(p)==="+"))return b=r.charAt(p),p+=1,f=x(p),a+=b+f[0],[a,"TK_WORD"];if(a==="in")return[a,"TK_OPERATOR"];Q&&u!=="TK_OPERATOR"&&u!=="TK_EQUALS"&&!n.if_line&&(V||v!=="var")&&g();return[a,"TK_WORD"]}if(a==="("||a==="[")return[a,"TK_START_EXPR"];if(a===")"||a==="]")return[a,"TK_END_EXPR"];if(a==="{")return[a,"TK_START_BLOCK"];if(a==="}")return[a,
"TK_END_BLOCK"];if(a===";")return[a,"TK_SEMICOLON"];if(a==="/"){b="";f=!0;if(r.charAt(p)==="*"){p+=1;if(p<E)for(;!(r.charAt(p)==="*"&&r.charAt(p+1)&&r.charAt(p+1)==="/")&&p<E;){a=r.charAt(p);b+=a;if(a==="\r"||a==="\n")f=!1;p+=1;if(p>=E)break}p+=2;return f?["/*"+b+"*/","TK_INLINE_COMMENT"]:["/*"+b+"*/","TK_BLOCK_COMMENT"]}if(r.charAt(p)==="/"){for(b=a;r.charAt(p)!=="\r"&&r.charAt(p)!=="\n";)if(b+=r.charAt(p),p+=1,p>=E)break;p+=1;Q&&g();return[b,"TK_COMMENT"]}}if(a==="'"||a==='"'||a==="/"&&(u==="TK_WORD"&&
s(v,["return","do"])||u==="TK_COMMENT"||u==="TK_START_EXPR"||u==="TK_START_BLOCK"||u==="TK_END_BLOCK"||u==="TK_OPERATOR"||u==="TK_EQUALS"||u==="TK_EOF"||u==="TK_SEMICOLON")){b=a;f=!1;var h=a;if(p<E)if(b==="/")for(a=!1;f||a||r.charAt(p)!==b;){if(h+=r.charAt(p),f?f=!1:(f=r.charAt(p)==="\\",r.charAt(p)==="["?a=!0:r.charAt(p)==="]"&&(a=!1)),p+=1,p>=E)return[h,"TK_STRING"]}else for(;f||r.charAt(p)!==b;)if(h+=r.charAt(p),f=f?!1:r.charAt(p)==="\\",p+=1,p>=E)return[h,"TK_STRING"];p+=1;h+=b;if(b==="/")for(;p<
E&&s(r.charAt(p),G);)h+=r.charAt(p),p+=1;return[h,"TK_STRING"]}if(a==="#"){if(o.length===0&&r.charAt(p)==="!"){for(h=a;p<E&&a!="\n";)a=r.charAt(p),h+=a,p+=1;o.push(d(h)+"\n");g();return x()}b="#";if(p<E&&s(r.charAt(p),I)){do a=r.charAt(p),b+=a,p+=1;while(p<E&&a!=="#"&&a!=="=");a!=="#"&&(r.charAt(p)==="["&&r.charAt(p+1)==="]"?(b+="[]",p+=2):r.charAt(p)==="{"&&r.charAt(p+1)==="}"&&(b+="{}",p+=2));return[b,"TK_WORD"]}}if(a==="<"&&r.substring(p-1,p+3)==="<\!--")return p+=3,n.in_html_comment=!0,["<\!--",
"TK_COMMENT"];if(a==="-"&&n.in_html_comment&&r.substring(p-1,p+2)==="--\>")return n.in_html_comment=!1,p+=2,Q&&g(),["--\>","TK_COMMENT"];if(s(a,H)){for(;p<E&&s(a+r.charAt(p),H);)if(a+=r.charAt(p),p+=1,p>=E)break;return a==="="?[a,"TK_EQUALS"]:[a,"TK_OPERATOR"]}return[a,"TK_UNKNOWN"]}var r,o,w,u,v,y,A,n,B,D,F,G,H,p,C,I,z,J,O,Q,N,L,T="",b=b?b:{},R;if(b.space_after_anon_function!==void 0&&b.jslint_happy===void 0)b.jslint_happy=b.space_after_anon_function;b.braces_on_own_line!==void 0&&(R=b.braces_on_own_line?
"expand":"collapse");R=b.brace_style?b.brace_style:R?R:"collapse";A=b.indent_size?b.indent_size:2;var U=b.indent_char?b.indent_char:" ",V=typeof b.preserve_newlines==="undefined"?!0:b.preserve_newlines,$=typeof b.max_preserve_newlines==="undefined"?!1:b.max_preserve_newlines,S=b.jslint_happy==="undefined"?!1:b.jslint_happy,K=typeof b.keep_array_indentation==="undefined"?!1:b.keep_array_indentation;N=!1;var E=a.length;for(D="";A>0;)D+=U,A-=1;for(;a&&(a[0]===" "||a[0]==="\t");)T+=a[0],a=a.substring(1);
r=a;A="";u="TK_START_EXPR";y=v="";o=[];O=!1;F="\n\r\t ".split("");G="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_$".split("");I="0123456789".split("");H="+ - * / % & ++ -- = += -= *= /= %= == === != !== > < >= <= >> << >>> >>>= >>= <<= && &= | || ! !! , : ? ^ ^= |= ::".split(" ");C="continue,try,throw,return,var,if,switch,case,default,for,while,break,function".split(",");B=[];l("BLOCK");for(p=0;;){J=x(p);w=J[0];J=J[1];if(J==="TK_EOF")break;switch(J){case "TK_START_EXPR":if(w===
"["){if(u==="TK_WORD"||v===")"){s(v,C)&&h();l("(EXPRESSION)");i();break}if(n.mode==="[EXPRESSION]"||n.mode==="[INDENTED-EXPRESSION]")if(y==="]"&&v===","){if(n.mode==="[EXPRESSION]")n.mode="[INDENTED-EXPRESSION]",K||(n.indentation_level+=1);l("[EXPRESSION]");K||g()}else if(v==="["){if(n.mode==="[EXPRESSION]")n.mode="[INDENTED-EXPRESSION]",K||(n.indentation_level+=1);l("[EXPRESSION]");K||g()}else l("[EXPRESSION]");else l("[EXPRESSION]")}else l("(EXPRESSION)");v===";"||u==="TK_START_BLOCK"?g():u==="TK_END_EXPR"||
u==="TK_START_EXPR"||u==="TK_END_BLOCK"||v==="."||(u!=="TK_WORD"&&u!=="TK_OPERATOR"?h():A==="function"||A==="typeof"?S&&h():(s(v,C)||v==="catch")&&h());i();break;case "TK_END_EXPR":if(w==="]")if(K){if(v==="}"){k();i();q();break}}else if(n.mode==="[INDENTED-EXPRESSION]"&&v==="]"){q();g();i();break}q();i();break;case "TK_START_BLOCK":A==="do"?l("DO_BLOCK"):l("BLOCK");R=="expand"?(u!=="TK_OPERATOR"&&(v==="return"||v==="="?h():g(!0)),i(),n.indentation_level+=1):(u!=="TK_OPERATOR"&&u!=="TK_START_EXPR"?
u==="TK_START_BLOCK"?g():h():m(n.previous_mode)&&v===","&&(y==="}"?h():g()),n.indentation_level+=1,i());break;case "TK_END_BLOCK":q();R=="expand"?v!=="{"&&g():u==="TK_START_BLOCK"?N?k():c():m(n.mode)&&K?(K=!1,g(),K=!0):g();i();break;case "TK_WORD":if(O){h();i();h();O=!1;break}if(w==="function"){if(n.var_line)n.var_line_reindented=!0;if((N||v===";")&&v!=="{"){L=N?L:0;V||(L=1);for(z=0;z<2-L;z++)g(!1)}}if(w==="case"||w==="default"){v===":"?k():(n.indentation_level--,g(),n.indentation_level++);i();n.in_case=
!0;break}z="NONE";u==="TK_END_BLOCK"?s(w.toLowerCase(),["else","catch","finally"])?R=="expand"||R=="end-expand"?z="NEWLINE":(z="SPACE",h()):z="NEWLINE":u==="TK_SEMICOLON"&&(n.mode==="BLOCK"||n.mode==="DO_BLOCK")?z="NEWLINE":u==="TK_SEMICOLON"&&j(n.mode)?z="SPACE":u==="TK_STRING"?z="NEWLINE":u==="TK_WORD"?(v==="else"&&c(!0),z="SPACE"):u==="TK_START_BLOCK"?z="NEWLINE":u==="TK_END_EXPR"&&(h(),z="NEWLINE");s(w,C)&&v!==")"&&(z=v=="else"?"SPACE":"NEWLINE");if(n.if_line&&u==="TK_END_EXPR")n.if_line=!1;if(s(w.toLowerCase(),
["else","catch","finally"]))u!=="TK_END_BLOCK"||R=="expand"||R=="end-expand"?g():(c(!0),h());else if(z==="NEWLINE"){if(!((u==="TK_START_EXPR"||v==="="||v===",")&&w==="function"))if(w==="function"&&v=="new")h();else if(v==="return"||v==="throw")h();else if(u!=="TK_END_EXPR"){if((u!=="TK_START_EXPR"||w!=="var")&&v!==":")w==="if"&&A==="else"&&v!=="{"?h():(n.var_line=!1,n.var_line_reindented=!1,g())}else if(s(w,C)&&v!=")")n.var_line=!1,n.var_line_reindented=!1,g()}else m(n.mode)&&v===","&&y==="}"?g():
z==="SPACE"&&h();i();A=w;if(w==="var")n.var_line=!0,n.var_line_reindented=!1,n.var_line_tainted=!1;if(w==="if")n.if_line=!0;if(w==="else")n.if_line=!1;break;case "TK_SEMICOLON":i();n.var_line=!1;n.var_line_reindented=!1;if(n.mode=="OBJECT")n.mode="BLOCK";break;case "TK_STRING":u==="TK_START_BLOCK"||u==="TK_END_BLOCK"||u==="TK_SEMICOLON"?g():u==="TK_WORD"&&h();i();break;case "TK_EQUALS":if(n.var_line)n.var_line_tainted=!0;h();i();h();break;case "TK_OPERATOR":z=y=!0;if(n.var_line&&w===","&&j(n.mode))n.var_line_tainted=
!1;if(n.var_line&&w===",")if(n.var_line_tainted){i();n.var_line_reindented=!0;n.var_line_tainted=!1;g();break}else n.var_line_tainted=!1;if(v==="return"||v==="throw"){h();i();break}if(w===":"&&n.in_case){i();g();n.in_case=!1;break}if(w==="::"){i();break}if(w===","){n.var_line?n.var_line_tainted?(i(),g(),n.var_line_tainted=!1):(i(),h()):u==="TK_END_BLOCK"&&n.mode!=="(EXPRESSION)"?(i(),n.mode==="OBJECT"&&v==="}"?g():h()):n.mode==="OBJECT"?(i(),g()):(i(),h());break}else s(w,["--","++","!"])||s(w,["-",
"+"])&&(s(u,["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"])||s(v,C))?(z=y=!1,v===";"&&j(n.mode)&&(y=!0),u==="TK_WORD"&&s(v,C)&&(y=!0),n.mode==="BLOCK"&&(v==="{"||v===";")&&g()):w==="."?y=!1:w===":"?n.ternary_depth==0?(n.mode="OBJECT",y=!1):n.ternary_depth-=1:w==="?"&&(n.ternary_depth+=1);y&&h();i();z&&h();break;case "TK_BLOCK_COMMENT":y=w.split(/\x0a|\x0d\x0a/);if(t(y.slice(1),"*")){g();o.push(y[0]);for(z=1;z<y.length;z++)g(),o.push(" "),o.push(d(y[z]))}else{y.length>1?(g(),c()):h();
for(z=0;z<y.length;z++)o.push(y[z]),o.push("\n")}g();break;case "TK_INLINE_COMMENT":h();i();j(n.mode)?h():f();break;case "TK_COMMENT":Q?g():h();i();f();break;case "TK_UNKNOWN":(v==="return"||v==="throw")&&h(),i()}y=v;u=J;v=w}return T+o.join("").replace(/[\n ]+$/,"")}if(typeof exports!=="undefined")exports.js_beautify=js_beautify;var glMatrixArrayType;glMatrixArrayType=typeof Float32Array!="undefined"?Float32Array:typeof WebGLFloatArray!="undefined"?WebGLFloatArray:Array;
var vec3={create:function(a){var b=new glMatrixArrayType(3);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b},add:function(a,b,c){if(!c||a==c)return a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a;c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];return c},subtract:function(a,b,c){if(!c||a==c)return a[0]-=b[0],a[1]-=b[1],a[2]-=b[2],a;c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];return c},negate:function(a,b){b||(b=a);b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b},scale:function(a,
b,c){if(!c||a==c)return a[0]*=b,a[1]*=b,a[2]*=b,a;c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;return c},normalize:function(a,b){b||(b=a);var c=a[0],d=a[1],f=a[2],g=Math.sqrt(c*c+d*d+f*f);if(g){if(g==1)return b[0]=c,b[1]=d,b[2]=f,b}else return b[0]=0,b[1]=0,b[2]=0,b;g=1/g;b[0]=c*g;b[1]=d*g;b[2]=f*g;return b},cross:function(a,b,c){c||(c=a);var d=a[0],f=a[1],a=a[2],g=b[0],h=b[1],b=b[2];c[0]=f*b-a*h;c[1]=a*g-d*b;c[2]=d*h-f*g;return c},length:function(a){var b=a[0],c=a[1],a=a[2];return Math.sqrt(b*b+c*c+a*a)},
dot:function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]},direction:function(a,b,c){c||(c=a);var d=a[0]-b[0],f=a[1]-b[1],a=a[2]-b[2],b=Math.sqrt(d*d+f*f+a*a);if(!b)return c[0]=0,c[1]=0,c[2]=0,c;b=1/b;c[0]=d*b;c[1]=f*b;c[2]=a*b;return c},lerp:function(a,b,c,d){d||(d=a);d[0]=a[0]+c*(b[0]-a[0]);d[1]=a[1]+c*(b[1]-a[1]);d[2]=a[2]+c*(b[2]-a[2]);return d},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"}},mat3={create:function(a){var b=new glMatrixArrayType(9);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=
a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,b){if(!b||a==b){var c=a[1],d=a[2],f=a[5];a[1]=a[3];a[2]=a[6];a[3]=c;a[5]=a[7];a[6]=d;a[7]=f;return a}b[0]=a[0];b[1]=a[3];b[2]=a[6];b[3]=a[1];b[4]=a[4];b[5]=a[7];b[6]=a[2];b[7]=a[5];b[8]=a[8];return b},toMat4:function(a,
b){b||(b=mat4.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=0;b[4]=a[3];b[5]=a[4];b[6]=a[5];b[7]=0;b[8]=a[6];b[9]=a[7];b[10]=a[8];b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"}},mat4={create:function(a){var b=new glMatrixArrayType(16);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],
b[14]=a[14],b[15]=a[15]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},transpose:function(a,b){if(!b||a==b){var c=a[1],d=a[2],f=a[3],g=a[6],h=a[7],i=a[11];a[1]=a[4];a[2]=a[8];a[3]=a[12];a[4]=
c;a[6]=a[9];a[7]=a[13];a[8]=d;a[9]=g;a[11]=a[14];a[12]=f;a[13]=h;a[14]=i;return a}b[0]=a[0];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=a[1];b[5]=a[5];b[6]=a[9];b[7]=a[13];b[8]=a[2];b[9]=a[6];b[10]=a[10];b[11]=a[14];b[12]=a[3];b[13]=a[7];b[14]=a[11];b[15]=a[15];return b},determinant:function(a){var b=a[0],c=a[1],d=a[2],f=a[3],g=a[4],h=a[5],i=a[6],k=a[7],l=a[8],m=a[9],j=a[10],q=a[11],t=a[12],s=a[13],x=a[14],a=a[15];return t*m*i*f-l*s*i*f-t*h*j*f+g*s*j*f+l*h*x*f-g*m*x*f-t*m*d*k+l*s*d*k+t*c*j*k-b*s*j*k-l*c*
x*k+b*m*x*k+t*h*d*q-g*s*d*q-t*c*i*q+b*s*i*q+g*c*x*q-b*h*x*q-l*h*d*a+g*m*d*a+l*c*i*a-b*m*i*a-g*c*j*a+b*h*j*a},inverse:function(a,b){b||(b=a);var c=a[0],d=a[1],f=a[2],g=a[3],h=a[4],i=a[5],k=a[6],l=a[7],m=a[8],j=a[9],q=a[10],t=a[11],s=a[12],x=a[13],r=a[14],o=a[15],w=c*i-d*h,u=c*k-f*h,v=c*l-g*h,y=d*k-f*i,A=d*l-g*i,n=f*l-g*k,B=m*x-j*s,D=m*r-q*s,F=m*o-t*s,G=j*r-q*x,H=j*o-t*x,p=q*o-t*r,C=1/(w*p-u*H+v*G+y*F-A*D+n*B);b[0]=(i*p-k*H+l*G)*C;b[1]=(-d*p+f*H-g*G)*C;b[2]=(x*n-r*A+o*y)*C;b[3]=(-j*n+q*A-t*y)*C;b[4]=
(-h*p+k*F-l*D)*C;b[5]=(c*p-f*F+g*D)*C;b[6]=(-s*n+r*v-o*u)*C;b[7]=(m*n-q*v+t*u)*C;b[8]=(h*H-i*F+l*B)*C;b[9]=(-c*H+d*F-g*B)*C;b[10]=(s*A-x*v+o*w)*C;b[11]=(-m*A+j*v-t*w)*C;b[12]=(-h*G+i*D-k*B)*C;b[13]=(c*G-d*D+f*B)*C;b[14]=(-s*y+x*u-r*w)*C;b[15]=(m*y-j*u+q*w)*C;return b}};mat4.toRotationMat=function(a,b){b||(b=mat4.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};
mat4.toMat3=function(a,b){b||(b=mat3.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=a[10];return b};mat4.toInverseMat3=function(a,b){var c=a[0],d=a[1],f=a[2],g=a[4],h=a[5],i=a[6],k=a[8],l=a[9],m=a[10],j=m*h-i*l,q=-m*g+i*k,t=l*g-h*k,s=c*j+d*q+f*t;if(!s)return null;s=1/s;b||(b=mat3.create());b[0]=j*s;b[1]=(-m*d+f*l)*s;b[2]=(i*d-f*h)*s;b[3]=q*s;b[4]=(m*c-f*k)*s;b[5]=(-i*c+f*g)*s;b[6]=t*s;b[7]=(-l*c+d*k)*s;b[8]=(h*c-d*g)*s;return b};
mat4.multiply=function(a,b,c){c||(c=a);var d=a[0],f=a[1],g=a[2],h=a[3],i=a[4],k=a[5],l=a[6],m=a[7],j=a[8],q=a[9],t=a[10],s=a[11],x=a[12],r=a[13],o=a[14],a=a[15],w=b[0],u=b[1],v=b[2],y=b[3],A=b[4],n=b[5],B=b[6],D=b[7],F=b[8],G=b[9],H=b[10],p=b[11],C=b[12],I=b[13],z=b[14],b=b[15];c[0]=w*d+u*i+v*j+y*x;c[1]=w*f+u*k+v*q+y*r;c[2]=w*g+u*l+v*t+y*o;c[3]=w*h+u*m+v*s+y*a;c[4]=A*d+n*i+B*j+D*x;c[5]=A*f+n*k+B*q+D*r;c[6]=A*g+n*l+B*t+D*o;c[7]=A*h+n*m+B*s+D*a;c[8]=F*d+G*i+H*j+p*x;c[9]=F*f+G*k+H*q+p*r;c[10]=F*g+G*
l+H*t+p*o;c[11]=F*h+G*m+H*s+p*a;c[12]=C*d+I*i+z*j+b*x;c[13]=C*f+I*k+z*q+b*r;c[14]=C*g+I*l+z*t+b*o;c[15]=C*h+I*m+z*s+b*a;return c};mat4.multiplyVec3=function(a,b,c){c||(c=b);var d=b[0],f=b[1],b=b[2];c[0]=a[0]*d+a[4]*f+a[8]*b+a[12];c[1]=a[1]*d+a[5]*f+a[9]*b+a[13];c[2]=a[2]*d+a[6]*f+a[10]*b+a[14];return c};
mat4.multiplyVec4=function(a,b,c){c||(c=b);var d=b[0],f=b[1],g=b[2],b=b[3];c[0]=a[0]*d+a[4]*f+a[8]*g+a[12]*b;c[1]=a[1]*d+a[5]*f+a[9]*g+a[13]*b;c[2]=a[2]*d+a[6]*f+a[10]*g+a[14]*b;c[3]=a[3]*d+a[7]*f+a[11]*g+a[15]*b;return c};
mat4.translate=function(a,b,c){var d=b[0],f=b[1],b=b[2];if(!c||a==c)return a[12]=a[0]*d+a[4]*f+a[8]*b+a[12],a[13]=a[1]*d+a[5]*f+a[9]*b+a[13],a[14]=a[2]*d+a[6]*f+a[10]*b+a[14],a[15]=a[3]*d+a[7]*f+a[11]*b+a[15],a;var g=a[0],h=a[1],i=a[2],k=a[3],l=a[4],m=a[5],j=a[6],q=a[7],t=a[8],s=a[9],x=a[10],r=a[11];c[0]=g;c[1]=h;c[2]=i;c[3]=k;c[4]=l;c[5]=m;c[6]=j;c[7]=q;c[8]=t;c[9]=s;c[10]=x;c[11]=r;c[12]=g*d+l*f+t*b+a[12];c[13]=h*d+m*f+s*b+a[13];c[14]=i*d+j*f+x*b+a[14];c[15]=k*d+q*f+r*b+a[15];return c};
mat4.scale=function(a,b,c){var d=b[0],f=b[1],b=b[2];if(!c||a==c)return a[0]*=d,a[1]*=d,a[2]*=d,a[3]*=d,a[4]*=f,a[5]*=f,a[6]*=f,a[7]*=f,a[8]*=b,a[9]*=b,a[10]*=b,a[11]*=b,a;c[0]=a[0]*d;c[1]=a[1]*d;c[2]=a[2]*d;c[3]=a[3]*d;c[4]=a[4]*f;c[5]=a[5]*f;c[6]=a[6]*f;c[7]=a[7]*f;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};
mat4.rotate=function(a,b,c,d){var f=c[0],g=c[1],c=c[2],h=Math.sqrt(f*f+g*g+c*c);if(!h)return null;h!=1&&(h=1/h,f*=h,g*=h,c*=h);var i=Math.sin(b),k=Math.cos(b),l=1-k,b=a[0],h=a[1],m=a[2],j=a[3],q=a[4],t=a[5],s=a[6],x=a[7],r=a[8],o=a[9],w=a[10],u=a[11],v=f*f*l+k,y=g*f*l+c*i,A=c*f*l-g*i,n=f*g*l-c*i,B=g*g*l+k,D=c*g*l+f*i,F=f*c*l+g*i,f=g*c*l-f*i,g=c*c*l+k;d?a!=d&&(d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]):d=a;d[0]=b*v+q*y+r*A;d[1]=h*v+t*y+o*A;d[2]=m*v+s*y+w*A;d[3]=j*v+x*y+u*A;d[4]=b*n+q*B+r*D;d[5]=
h*n+t*B+o*D;d[6]=m*n+s*B+w*D;d[7]=j*n+x*B+u*D;d[8]=b*F+q*f+r*g;d[9]=h*F+t*f+o*g;d[10]=m*F+s*f+w*g;d[11]=j*F+x*f+u*g;return d};mat4.rotateX=function(a,b,c){var d=Math.sin(b),b=Math.cos(b),f=a[4],g=a[5],h=a[6],i=a[7],k=a[8],l=a[9],m=a[10],j=a[11];c?a!=c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[4]=f*b+k*d;c[5]=g*b+l*d;c[6]=h*b+m*d;c[7]=i*b+j*d;c[8]=f*-d+k*b;c[9]=g*-d+l*b;c[10]=h*-d+m*b;c[11]=i*-d+j*b;return c};
mat4.rotateY=function(a,b,c){var d=Math.sin(b),b=Math.cos(b),f=a[0],g=a[1],h=a[2],i=a[3],k=a[8],l=a[9],m=a[10],j=a[11];c?a!=c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=f*b+k*-d;c[1]=g*b+l*-d;c[2]=h*b+m*-d;c[3]=i*b+j*-d;c[8]=f*d+k*b;c[9]=g*d+l*b;c[10]=h*d+m*b;c[11]=i*d+j*b;return c};
mat4.rotateZ=function(a,b,c){var d=Math.sin(b),b=Math.cos(b),f=a[0],g=a[1],h=a[2],i=a[3],k=a[4],l=a[5],m=a[6],j=a[7];c?a!=c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=f*b+k*d;c[1]=g*b+l*d;c[2]=h*b+m*d;c[3]=i*b+j*d;c[4]=f*-d+k*b;c[5]=g*-d+l*b;c[6]=h*-d+m*b;c[7]=i*-d+j*b;return c};
mat4.frustum=function(a,b,c,d,f,g,h){h||(h=mat4.create());var i=b-a,k=d-c,l=g-f;h[0]=f*2/i;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=f*2/k;h[6]=0;h[7]=0;h[8]=(b+a)/i;h[9]=(d+c)/k;h[10]=-(g+f)/l;h[11]=-1;h[12]=0;h[13]=0;h[14]=-(g*f*2)/l;h[15]=0;return h};mat4.perspective=function(a,b,c,d,f,g){a=c*Math.tan(a*Math.PI/360);b*=a;return mat4.frustum(-b,b,-a*(g?-1:1),a*(g?-1:1),c,d,f)};
mat4.ortho=function(a,b,c,d,f,g,h){h||(h=mat4.create());var i=b-a,k=d-c,l=g-f;h[0]=2/i;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2/k;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=-2/l;h[11]=0;h[12]=-(a+b)/i;h[13]=-(d+c)/k;h[14]=-(g+f)/l;h[15]=1;return h};
mat4.lookAt=function(a,b,c,d){d||(d=mat4.create());var f=a[0],g=a[1],a=a[2],h=c[0],i=c[1],k=c[2],c=b[1],l=b[2];if(f==b[0]&&g==c&&a==l)return mat4.identity(d);var m,j,q,t,c=f-b[0],l=g-b[1],b=a-b[2];t=1/Math.sqrt(c*c+l*l+b*b);c*=t;l*=t;b*=t;m=i*b-k*l;k=k*c-h*b;h=h*l-i*c;(t=Math.sqrt(m*m+k*k+h*h))?(t=1/t,m*=t,k*=t,h*=t):h=k=m=0;i=l*h-b*k;j=b*m-c*h;q=c*k-l*m;(t=Math.sqrt(i*i+j*j+q*q))?(t=1/t,i*=t,j*=t,q*=t):q=j=i=0;d[0]=m;d[1]=i;d[2]=c;d[3]=0;d[4]=k;d[5]=j;d[6]=l;d[7]=0;d[8]=h;d[9]=q;d[10]=b;d[11]=0;
d[12]=-(m*f+k*g+h*a);d[13]=-(i*f+j*g+q*a);d[14]=-(c*f+l*g+b*a);d[15]=1;return d};mat4.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"};
var quat4={create:function(a){var b=new glMatrixArrayType(4);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},calculateW:function(a,b){var c=a[0],d=a[1],f=a[2];if(!b||a==b)return a[3]=-Math.sqrt(Math.abs(1-c*c-d*d-f*f)),a;b[0]=c;b[1]=d;b[2]=f;b[3]=-Math.sqrt(Math.abs(1-c*c-d*d-f*f));return b},inverse:function(a,b){if(!b||a==b)return a[0]*=-1,a[1]*=-1,a[2]*=-1,a;b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b},length:function(a){var b=
a[0],c=a[1],d=a[2],a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)},normalize:function(a,b){b||(b=a);var c=a[0],d=a[1],f=a[2],g=a[3],h=Math.sqrt(c*c+d*d+f*f+g*g);if(h==0)return b[0]=0,b[1]=0,b[2]=0,b[3]=0,b;h=1/h;b[0]=c*h;b[1]=d*h;b[2]=f*h;b[3]=g*h;return b},multiply:function(a,b,c){c||(c=a);var d=a[0],f=a[1],g=a[2],a=a[3],h=b[0],i=b[1],k=b[2],b=b[3];c[0]=d*b+a*h+f*k-g*i;c[1]=f*b+a*i+g*h-d*k;c[2]=g*b+a*k+d*i-f*h;c[3]=a*b-d*h-f*i-g*k;return c},multiplyVec3:function(a,b,c){c||(c=b);var d=b[0],f=b[1],g=b[2],
b=a[0],h=a[1],i=a[2],a=a[3],k=a*d+h*g-i*f,l=a*f+i*d-b*g,m=a*g+b*f-h*d,d=-b*d-h*f-i*g;c[0]=k*a+d*-b+l*-i-m*-h;c[1]=l*a+d*-h+m*-b-k*-i;c[2]=m*a+d*-i+k*-h-l*-b;return c},toMat3:function(a,b){b||(b=mat3.create());var c=a[0],d=a[1],f=a[2],g=a[3],h=c+c,i=d+d,k=f+f,l=c*h,m=c*i;c*=k;var j=d*i;d*=k;f*=k;h*=g;i*=g;g*=k;b[0]=1-(j+f);b[1]=m-g;b[2]=c+i;b[3]=m+g;b[4]=1-(l+f);b[5]=d-h;b[6]=c-i;b[7]=d+h;b[8]=1-(l+j);return b},toMat4:function(a,b){b||(b=mat4.create());var c=a[0],d=a[1],f=a[2],g=a[3],h=c+c,i=d+d,k=
f+f,l=c*h,m=c*i;c*=k;var j=d*i;d*=k;f*=k;h*=g;i*=g;g*=k;b[0]=1-(j+f);b[1]=m-g;b[2]=c+i;b[3]=0;b[4]=m+g;b[5]=1-(l+f);b[6]=d-h;b[7]=0;b[8]=c-i;b[9]=d+h;b[10]=1-(l+j);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b},slerp:function(a,b,c,d){d||(d=a);var f=a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3];if(Math.abs(f)>=1)return d!=a&&(d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3]),d;var g=Math.acos(f),h=Math.sqrt(1-f*f);if(Math.abs(h)<0.0010)return d[0]=a[0]*0.5+b[0]*0.5,d[1]=a[1]*0.5+b[1]*0.5,d[2]=a[2]*0.5+b[2]*0.5,
d[3]=a[3]*0.5+b[3]*0.5,d;f=Math.sin((1-c)*g)/h;c=Math.sin(c*g)/h;d[0]=a[0]*f+b[0]*c;d[1]=a[1]*f+b[1]*c;d[2]=a[2]*f+b[2]*c;d[3]=a[3]*f+b[3]*c;return d},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}},Tilt=Tilt||{},EXPORTED_SYMBOLS=["Tilt.Cube"];
Tilt.Cube=function(a,b,c){Tilt.Profiler.intercept("Tilt.Cube",this);a=a||1;b=b||1;c=c||1;this.vertices=new Tilt.VertexBuffer([-0.5*a,-0.5*b,0.5*c,0.5*a,-0.5*b,0.5*c,0.5*a,0.5*b,0.5*c,-0.5*a,0.5*b,0.5*c,-0.5*a,0.5*b,0.5*c,0.5*a,0.5*b,0.5*c,0.5*a,0.5*b,-0.5*c,-0.5*a,0.5*b,-0.5*c,0.5*a,-0.5*b,-0.5*c,-0.5*a,-0.5*b,-0.5*c,-0.5*a,0.5*b,-0.5*c,0.5*a,0.5*b,-0.5*c,-0.5*a,-0.5*b,-0.5*c,0.5*a,-0.5*b,-0.5*c,0.5*a,-0.5*b,0.5*c,-0.5*a,-0.5*b,0.5*c,0.5*a,-0.5*b,0.5*c,0.5*a,-0.5*b,-0.5*c,0.5*a,0.5*b,-0.5*c,0.5*a,
0.5*b,0.5*c,-0.5*a,-0.5*b,-0.5*c,-0.5*a,-0.5*b,0.5*c,-0.5*a,0.5*b,0.5*c,-0.5*a,0.5*b,-0.5*c],3);this.texCoord=new Tilt.VertexBuffer([0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1],2);this.indices=new Tilt.IndexBuffer([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23])};Tilt.Cube.prototype={destroy:function(){Tilt.destroyObject(this)}};Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.CubeWireframe"];
Tilt.CubeWireframe=function(a,b,c){Tilt.Profiler.intercept("Tilt.CubeWireframe",this);a=a||1;b=b||1;c=c||1;this.vertices=new Tilt.VertexBuffer([-0.5*a,-0.5*b,0.5*c,0.5*a,-0.5*b,0.5*c,0.5*a,0.5*b,0.5*c,-0.5*a,0.5*b,0.5*c,0.5*a,-0.5*b,-0.5*c,-0.5*a,-0.5*b,-0.5*c,-0.5*a,0.5*b,-0.5*c,0.5*a,0.5*b,-0.5*c],3);this.indices=new Tilt.IndexBuffer([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,5,1,4,2,7,3,6])};Tilt.CubeWireframe.prototype={destroy:function(){Tilt.destroyObject(this)}};Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.Rectangle"];
Tilt.Rectangle=function(){Tilt.Profiler.intercept("Tilt.Rectangle",this);this.vertices=new Tilt.VertexBuffer([0,0,1,0,0,1,1,1],2);this.texCoord=new Tilt.VertexBuffer([0,0,1,0,0,1,1,1],2)};Tilt.Rectangle.prototype={destroy:function(){Tilt.destroyObject(this)}};Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.RectangleWireframe"];Tilt.RectangleWireframe=function(){Tilt.Profiler.intercept("Tilt.RectangleWireframe",this);this.vertices=new Tilt.VertexBuffer([0,0,1,0,1,1,0,1],2)};
Tilt.RectangleWireframe.prototype={destroy:function(){Tilt.destroyObject(this)}};Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.Mesh"];Tilt.Mesh=function(a){Tilt.Profiler.intercept("Tilt.Mesh",this);for(var b in a)this[b]!=="draw"&&(this[b]=a[b]);if("undefined"===typeof this.color)this.color=[1,1,1,1];if("undefined"===typeof this.drawMode)this.drawMode=Tilt.$renderer.TRIANGLES;if("function"===typeof a.draw)this.draw=a.draw};
Tilt.Mesh.prototype={draw:function(){var a=Tilt.$renderer,b=this.vertices,c=this.texCoord,d=this.indices,f=this.color,g=this.texture,h=this.drawMode;g?a.useTextureShader(b,c,f,g):a.useColorShader(b,f);d?a.drawIndexedVertices(h,d):a.drawVertices(h,b.numItems)},destroy:function(){Tilt.destroyObject(this)}};Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.Mesh"];
Tilt.Mesh.prototype.save=function(a,b){var c=[],d=[],f=this.vertices.components,g=this.texCoord.components,h=this.indices.components,i,k;c.push("mtllib "+b+".mtl","usemtl webpage");d.push("newmtl webpage","illum 2","Ka 1.000 1.000 1.000","Kd 1.000 1.000 1.000","Ks 0.000 0.000 0.000","map_Ka "+b+".png","map_Kd "+b+".png","map_Ks "+b+".png");for(i=0,k=f.length;i<k;i+=3)c.push("v "+f[i]/100+" "+f[i+1]/-100+" "+f[i+2]/100);for(i=0,k=g.length;i<k;i+=2)c.push("vt "+g[i]+" "+(1-g[i+1]));for(i=0,k=h.length;i<
k;i+=3)c.push("f "+(h[i]+1)+"/"+(h[i]+1)+" "+(h[i+1]+1)+"/"+(h[i+1]+1)+" "+(h[i+2]+1)+"/"+(h[i+2]+1));f=Tilt.File.separator;Tilt.File.save(c.join("\n"),a+f+b+".obj");Tilt.File.save(d.join("\n"),a+f+b+".mtl")};Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.Renderer"];
Tilt.Renderer=function(a,b){Tilt.Profiler.intercept("Tilt.Renderer",this);b=b||{};this.canvas=a;this.gl=this.create3DContext(a);Tilt.clearCache();Tilt.$gl=this.gl;Tilt.$renderer=this;if("undefined"!==typeof this.gl&&this.gl!==null){if("function"===typeof b.onsuccess)b.onsuccess();this.TRIANGLES=this.gl.TRIANGLES;this.TRIANGLE_STRIP=this.gl.TRIANGLE_STRIP;this.TRIANGLE_FAN=this.gl.TRIANGLE_FAN;this.LINES=this.gl.LINES;this.LINE_STRIP=this.gl.LINE_STRIP;this.LINE_LOOP=this.gl.LINE_LOOP;this.POINTS=
this.gl.POINTS;this.COLOR_BUFFER_BIT=this.gl.COLOR_BUFFER_BIT;this.DEPTH_BUFFER_BIT=this.gl.DEPTH_BUFFER_BIT;this.STENCIL_BUFFER_BIT=this.gl.STENCIL_BUFFER_BIT;this.gl.clearColor(0,0,0,1);this.gl.clearDepth(1)}else if(Tilt.Console.log(Tilt.StringBundle.get("initWebGL.error")),"function"===typeof b.onfail){b.onfail();return}this.$lastTime=0;this.$currentTime=null;this.frameDelta=this.frameRate=this.frameCount=this.elapsedTime=0;this.width=a.width;this.height=a.height;this.mvMatrixStack=[];this.mvMatrix=
mat4.identity(mat4.create());this.projMatrix=mat4.identity(mat4.create());this.$clearColor=[0,0,0,0];this.$tintColor=[1,1,1,1];this.$fillColor=[1,1,1,1];this.$strokeColor=[0,0,0,1];this.$strokeWeightValue=1;this.colorShader=new Tilt.Program(Tilt.Shaders.Color.vs,Tilt.Shaders.Color.fs);this.textureShader=new Tilt.Program(Tilt.Shaders.Texture.vs,Tilt.Shaders.Texture.fs);this.$rectangle=new Tilt.Rectangle;this.$rectangleWireframe=new Tilt.RectangleWireframe;this.$cube=new Tilt.Cube;this.$cubeWireframe=
new Tilt.CubeWireframe;this.origin();this.perspective();this.defaults()};
Tilt.Renderer.prototype={clear:function(a,b,c,d){var f=this.$clearColor,g=this.gl;if(f[0]!==a||f[1]!==b||f[2]!==c||f[3]!==d)f[0]=a,f[1]=b,f[2]=c,f[3]=d,g.clearColor(a,b,c,d),a*=255,b*=255,c*=255,d*=255,this.canvas.setAttribute("style",["background: rgba(",a,", ",b,", ",c,", ",d,"); width: 100%; height: 100%;"].join(""));g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT)},background:function(a){a="string"===typeof a?Tilt.Math.hex2rgba(a):"undefined"===typeof a?[0,0,0,1]:"number"===typeof a?[a/255,a/255,
a/255,1]:[a[0]/255,a[1]/255,a[2]/255,a[3]/255];this.clear(a[0],a[1],a[2],a[3])},perspective:function(){var a=this.width,b=this.height,c=a/2,d=b/2,f=d/Math.tan(Tilt.Math.radians(45)/2);mat4.perspective(45,a/b,f/10,f*10,this.projMatrix,!0);mat4.translate(this.projMatrix,[-c,-d,-f]);mat4.identity(this.mvMatrix);this.depthTest(!0)},ortho:function(){mat4.ortho(0,this.width,this.height,0,-1E6,1E6,this.projMatrix);mat4.translate(this.projMatrix,[0,0,-999999]);mat4.identity(this.mvMatrix);this.depthTest(!1)},
projection:function(a){mat4.set(a,this.projMatrix)},pushMatrix:function(){this.mvMatrixStack.push(mat4.create(this.mvMatrix))},popMatrix:function(){if(this.mvMatrixStack.length>0)this.mvMatrix=this.mvMatrixStack.pop()},origin:function(){mat4.identity(this.mvMatrix)},transform:function(a){mat4.multiply(this.mvMatrix,a)},translate:function(a,b,c){mat4.translate(this.mvMatrix,[a,b,c||0])},rotate:function(a,b,c,d){mat4.rotate(this.mvMatrix,a,[b,c,d])},rotateX:function(a){mat4.rotateX(this.mvMatrix,a)},
rotateY:function(a){mat4.rotateY(this.mvMatrix,a)},rotateZ:function(a){mat4.rotateZ(this.mvMatrix,a)},rotateXYZ:function(a,b,c){mat4.rotateX(this.mvMatrix,a);mat4.rotateY(this.mvMatrix,b);mat4.rotateZ(this.mvMatrix,c)},scale:function(a,b,c){mat4.scale(this.mvMatrix,[a,b,c||0])},tint:function(a){var a=Tilt.Math.hex2rgba(a),b=this.$tintColor;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]},noTint:function(){var a=this.$tintColor;a[0]=1;a[1]=1;a[2]=1;a[3]=1},fill:function(a){var a=Tilt.Math.hex2rgba(a),b=this.$fillColor;
b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]},noFill:function(){var a=this.$fillColor;a[0]=0;a[1]=0;a[2]=0;a[3]=0},stroke:function(a){var a=Tilt.Math.hex2rgba(a),b=this.$strokeColor;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]},noStroke:function(){var a=this.$strokeColor;a[0]=0;a[1]=0;a[2]=0;a[3]=0},strokeWeight:function(a){if(this.$strokeWeightValue!==a)this.$strokeWeightValue=a,this.gl.lineWidth(a)},blendMode:function(a){var b=this.gl;"alpha"===a?(b.enable(b.BLEND),b.blendFunc(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA)):
"add"===a||"additive"===a?(b.enable(b.BLEND),b.blendFunc(b.SRC_ALPHA,b.ONE)):b.disable(b.BLEND)},depthTest:function(a){var b=this.gl;a?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST)},stencilTest:function(a){var b=this.gl;a?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST)},defaults:function(){this.tint("#fff");this.fill("#fff");this.stroke("#000");this.strokeWeight(1);this.depthTest(!0);this.stencilTest(!1);this.blendMode("alpha")},useColorShader:function(a,b){var c=this.colorShader;c.use();c.bindVertexBuffer("vertexPosition",
a);c.bindUniformMatrix("mvMatrix",this.mvMatrix);c.bindUniformMatrix("projMatrix",this.projMatrix);c.bindUniformVec4("color",b)},useTextureShader:function(a,b,c,d){var f=this.textureShader;f.use();f.bindVertexBuffer("vertexPosition",a);f.bindVertexBuffer("vertexTexCoord",b);f.bindUniformMatrix("mvMatrix",this.mvMatrix);f.bindUniformMatrix("projMatrix",this.projMatrix);f.bindUniformVec4("color",c);f.bindTexture("sampler",d)},triangle:function(a,b,c){var d=this.$fillColor,f=this.$strokeColor,a=new Tilt.VertexBuffer([a[0],
a[1],a[2]||0,b[0],b[1],b[2]||0,c[0],c[1],c[2]||0],3);d[3]&&(this.useColorShader(a,d),this.drawVertices(this.TRIANGLE_STRIP,a.numItems));f[3]&&(this.useColorShader(a,f),this.drawVertices(this.LINE_LOOP,a.numItems));a.destroy()},quad:function(a,b,c,d){var f=this.$fillColor,g=this.$strokeColor,a=new Tilt.VertexBuffer([a[0],a[1],a[2]||0,b[0],b[1],b[2]||0,c[0],c[1],c[2]||0,d[0],d[1],d[2]||0],3);f[3]&&(this.useColorShader(a,f),this.drawVertices(this.TRIANGLE_FAN,a.numItems));g[3]&&(this.useColorShader(a,
g),this.drawVertices(this.LINE_LOOP,a.numItems));a.destroy()},rectMode:function(a){this.$rectangle.rectModeValue=a},rect:function(a,b,c,d){var f=this.$fillColor,g=this.$strokeColor,h=this.$rectangle.vertices,i=this.$rectangleWireframe.vertices;"center"===this.$rectangle.rectModeValue&&(a-=c/2,b-=d/2);this.pushMatrix();this.translate(a,b,0);this.scale(c,d,1);f[3]&&(this.useColorShader(h,f),this.drawVertices(this.TRIANGLE_STRIP,h.numItems));g[3]&&(this.useColorShader(i,g),this.drawVertices(this.LINE_LOOP,
i.numItems));this.popMatrix()},imageMode:function(a){this.$rectangle.imageModeValue=a},image:function(a,b,c,d,f,g){if(a.loaded){var h=this.$rectangle,i=this.$tintColor,k=h.vertices,g=g||h.texCoord;if("undefined"===typeof d||"undefined"===typeof f)d=a.width,f=a.height;"center"===h.imageModeValue&&(b-=d*0.5,c-=f*0.5);i[3]&&(this.pushMatrix(),this.translate(b,c,0),this.scale(d,f,1),this.useTextureShader(k,g,i,a),this.drawVertices(this.TRIANGLE_STRIP,k.numItems),this.popMatrix())}},box:function(a,b,c,
d){var f=this.$cube,g=this.$cubeWireframe,h=this.$tintColor,i=this.$fillColor,k=this.$strokeColor;this.pushMatrix();this.scale(a,b,c);d?h[3]&&(this.useTextureShader(f.vertices,f.texCoord,h,d),this.drawIndexedVertices(this.TRIANGLES,f.indices)):i[3]&&(this.useColorShader(f.vertices,i),this.drawIndexedVertices(this.TRIANGLES,f.indices));k[3]&&(this.useColorShader(g.vertices,k),this.drawIndexedVertices(this.LINES,g.indices));this.popMatrix()},drawVertices:function(a,b){this.gl.drawArrays(a,0,b)},drawIndexedVertices:function(a,
b){var c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,b.$ref);c.drawElements(a,b.numItems,c.UNSIGNED_SHORT,0)},create3DContext:function(a,b){var c=["experimental-webgl","webgl","webkit-3d","moz-webgl"],d,f,g;for(f=0,g=c.length;f<g;f++)try{d=a.getContext(c[f],b)}catch(h){}finally{if(d)return d}},loop:function(a,b){window.requestAnimFrame(a);this.perspective();this.frameCount++;if(b){this.$currentTime=(new Date).getTime();if(this.$lastTime!==0)this.frameDelta=this.$currentTime-this.$lastTime,this.frameRate=
1E3/this.frameDelta;this.$lastTime=this.$currentTime;this.elapsedTime+=this.frameDelta}},destroy:function(){Tilt.clearCache();Tilt.destroyObject(this)}};window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)}}();Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.Shaders.Color"];Tilt.Shaders={};
Tilt.Shaders.Color={vs:"attribute vec3 vertexPosition;\nuniform mat4 mvMatrix;\nuniform mat4 projMatrix;\nvoid main(void) {\n    gl_Position = projMatrix * mvMatrix * vec4(vertexPosition, 1.0);\n}",fs:"#ifdef GL_ES\nprecision lowp float;\n#endif\nuniform vec4 color;\nvoid main(void) {\n    gl_FragColor = color;\n}"};
Tilt.Shaders.Texture={vs:"attribute vec3 vertexPosition;\nattribute vec2 vertexTexCoord;\nuniform mat4 mvMatrix;\nuniform mat4 projMatrix;\nvarying vec2 texCoord;\nvoid main(void) {\n  gl_Position = projMatrix * mvMatrix * vec4(vertexPosition, 1.0);\n  texCoord = vertexTexCoord;\n}",fs:"#ifdef GL_ES\nprecision lowp float;\n#endif\nuniform vec4 color;\nuniform sampler2D sampler;\nvarying vec2 texCoord;\nvoid main(void) {\n  vec4 texture = texture2D(sampler, texCoord);\n  gl_FragColor = color * texture;\n}"};
Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.Container"];Tilt.Container=function(a){Tilt.Profiler.intercept("Tilt.Container",this);a=a||{};this.hidden=a.hidden||!1;this.disabled=a.disabled||!1;this.standby=a.standby||!1;this.$background=a.background||null;this.$x=a.x||0;this.$y=a.y||0;this.$width=a.width||0;this.$height=a.height||0;this.$offset=a.offset||[0,0];a.elements instanceof Array&&a.elements.forEach(function(a){this.push(a)}.bind(this));Tilt.UI.push(this)};Tilt.Container.prototype=[];
Tilt.Container.prototype.setPosition=function(a,b){this.$x=a;this.$y=b};Tilt.Container.prototype.setSize=function(a,b){this.$width=a;this.$height=b};Tilt.Container.prototype.setX=function(a){this.$x=a};Tilt.Container.prototype.setY=function(a){this.$y=a};Tilt.Container.prototype.setWidth=function(a){this.$width=a};Tilt.Container.prototype.setHeight=function(a){this.$height=a};Tilt.Container.prototype.getX=function(){return this.$x};Tilt.Container.prototype.getY=function(){return this.$y};
Tilt.Container.prototype.getWidth=function(){return this.$width};Tilt.Container.prototype.getHeight=function(){return this.$height};Tilt.Container.prototype.update=function(){};
Tilt.Container.prototype.draw=function(a,b){var b=b||Tilt.$renderer,c;c=this.$background;var d=this.$x,f=this.$y,g=this.$width,h=this.$height,i=this.$offset,k=d+i[0],i=f+i[1],l,m,j,q,t,s,x,r,o,w;c!==null&&(b.fill(c),b.noStroke(),b.rect(d,f,g||b.width,h||b.height));b.pushMatrix();b.translate(k,i,0);for(o=0,w=this.length;o<w;o++)if(c=this[o],c.drawable=!1,c.$parentX=d,c.$parentY=f,c.$parentWidth=g,c.$parentHeight=h,!c.hidden)if("function"===typeof c.update&&!c.hidden&&!c.disabled&&c.update(a,b),g===
0||h===0)c.draw(a,b),c.drawable=!0;else if(l=c.$bounds||[1,1,1,1],m=l[0]+k,j=l[1]+i,q=l[2],t=l[3],l=m,s=j,m+=q,j+=t,q=d,t=f,x=d+g,r=f+h,l>q&&m<x&&s>t&&j<r)c.draw(a,b),c.drawable=!0;b.popMatrix()};Tilt.Container.prototype.isMouseOver=function(a){var b=Tilt.UI,c=b.mouseX,b=b.mouseY,d=this.$offset||[0,0],f=a.$bounds||[-1,-1,-1,-1],a=f[0]+(this.$x||0+d[0]),d=f[1]+(this.$y||0+d[1]),g=f[2],f=f[3];return c>a&&c<a+g&&b>d&&b<d+f};
Tilt.Container.prototype.clear=function(){for(var a=0,b=this.length;a<b;a++)this[a].destroy(),this[a]=null;this.splice(0,this.length)};Tilt.Container.prototype.destroy=function(){Tilt.UI.splice(Tilt.UI.indexOf(this),1);Tilt.destroyObject(this)};Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.Scrollview"];
Tilt.ScrollContainer=function(a){Tilt.Profiler.intercept("Tilt.ScrollContainer",this);Tilt.UI.push(this);this.view=new Tilt.Container(a);this.view.standby=!0;this.scrollbars=new Tilt.Container;this.top=a.scrollable[0]||0;this.bottom=a.scrollable[1]||Number.MAX_VALUE;this.view.$offset[1]=this.top;var b=new Tilt.Button(a.top,{x:this.view.$x-25,y:this.view.$y-5,width:32,height:30,fill:a.top?null:"#f00a",padding:a.top?a.top.$padding:[0,0,0,0],onmousedown:function(){window.clearInterval(this.$scrollTopReset);
window.clearInterval(this.$scrollTop);window.clearInterval(this.$scrollBottom);var a=Tilt.UI,b=this.view,c=b.$offset;this.$scrollTop=window.setInterval(function(){c[1]=Tilt.Math.clamp(c[1]+5,this.top,-this.bottom+b.$height);a.requestRedraw();a.mousePressed||(c=b=a=null,window.clearInterval(this.$scrollTop))}.bind(this),1E3/60)}.bind(this)}),c=new Tilt.Button(a.bottom,{x:this.view.$x-25,y:this.view.$y+this.view.$height-25,width:32,height:30,fill:a.bottom?null:"#0f0a",padding:a.bottom?a.bottom.$padding:
[0,0,0,0],onmousedown:function(){window.clearInterval(this.$scrollTopReset);window.clearInterval(this.$scrollTop);window.clearInterval(this.$scrollBottom);var a=Tilt.UI,b=this.view,c=b.$offset;this.$scrollBottom=window.setInterval(function(){c[1]=Tilt.Math.clamp(c[1]-5,this.top,-this.bottom+b.$height);a.requestRedraw();a.mousePressed||(c=b=a=null,window.clearInterval(this.$scrollBottom))}.bind(this),1E3/60)}.bind(this)}),a=new Tilt.Button(a.reset,{x:this.view.$x-25,y:this.view.$y+this.view.$height-
50,width:32,height:30,fill:a.reset?null:"#0f0b",padding:a.reset?a.reset.$padding:[0,0,0,0],onmousedown:function(){window.clearInterval(this.$scrollTopReset);window.clearInterval(this.$scrollTop);window.clearInterval(this.$scrollBottom);var a=Tilt.UI,b=this.view,c=b.$offset;this.$scrollTopReset=window.setInterval(function(){c[1]-=(c[1]-this.top)/10;a.requestRedraw();Math.abs(c[1]-this.top)<0.1&&(c=b=a=null,window.clearInterval(this.$scrollTopReset))}.bind(this),1E3/60)}.bind(this)});this.view.onmousescroll=
function(a){window.clearInterval(this.$scrollTopReset);window.clearInterval(this.$scrollTop);window.clearInterval(this.$scrollBottom);var b=Tilt.UI,c=this.view,h=c.$offset;h[1]=Tilt.Math.clamp(h[1]-a/2,this.top,-this.bottom+c.$height);b.requestRedraw()}.bind(this);this.scrollbars.push(b,c,a);a=c=b=null};
Tilt.ScrollContainer.prototype={update:function(){this.scrollbars.hidden=this.view.hidden;this.scrollbars.disabled=this.view.disabled},draw:function(){},destroy:function(){Tilt.UI.splice(Tilt.UI.indexOf(this),1);Tilt.destroyObject(this)}};Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.Button"];
Tilt.Button=function(a,b){Tilt.Profiler.intercept("Tilt.Button",this);b=b||{};this.hidden=b.hidden||!1;this.disabled=b.disabled||!1;this.onmousedown=b.onmousedown||void 0;this.onmouseup=b.onmouseup||void 0;this.onclick=b.onclick||void 0;this.$sprite=a||{$x:-1,$y:-1,$width:-1,$height:-1};this.$sprite.$x=b.x||this.$sprite.$x;this.$sprite.$y=b.y||this.$sprite.$y;this.$sprite.$width=b.width||this.$sprite.$width;this.$sprite.$height=b.height||this.$sprite.$height;this.$sprite.disabled=!0;this.$padding=
b.padding||[0,0,0,0];this.$fill=b.fill||null;this.$stroke=b.stroke||null;this.$bounds=[this.$sprite.$x+this.$padding[0],this.$sprite.$y+this.$padding[1],this.$sprite.$width-this.$padding[0]-this.$padding[2],this.$sprite.$height-this.$padding[1]-this.$padding[3]]};
Tilt.Button.prototype={setPosition:function(a,b){"function"===typeof this.$sprite.setPosition?this.$sprite.setPosition(a,b):(this.$sprite.$x=a,this.$sprite.$y=b);this.$bounds[0]=a+this.$padding[0];this.$bounds[1]=b+this.$padding[1]},setSize:function(a,b){"function"===typeof this.$sprite.setSize?this.$sprite.setSize(a,b):(this.$sprite.$width=a,this.$sprite.$height=b);this.$bounds[2]=a-this.$padding[0]-this.$padding[2];this.$bounds[3]=b-this.$padding[1]-this.$padding[3]},setX:function(a){this.setPosition(a,
this.$sprite.$y)},setY:function(a){this.setPosition(this.$sprite.$x,a)},setWidth:function(a){this.setSize(a,this.$sprite.$height)},setHeight:function(a){this.setSize(this.$sprite.$width,a)},setSprite:function(a){var b=this.$sprite.$x,c=this.$sprite.$y,d=this.$sprite.$width,f=this.$sprite.$height,g=this.$sprite.$padding;this.$sprite=a;this.$sprite.$padding=g;this.$sprite.setPosition(b,c);this.$sprite.setSize(d,f);this.$sprite.disabled=!0},setFill:function(a){this.$fill=a},setStroke:function(a){this.$stroke=
a},getX:function(){return this.$sprite.$x},getY:function(){return this.$sprite.$y},getWidth:function(){return this.$sprite.$width},getHeight:function(){return this.$sprite.$height},getFill:function(){return this.$fill},getStroke:function(){return this.$stroke},draw:function(a,b){b=b||Tilt.$renderer;"undefined"!==typeof this.$sprite.$texture&&this.$sprite.draw(b);var c,d,f=this.$fill,g=this.$stroke;if(f||g)c=this.$bounds,d=this.$padding,b.fill(f||"#fff0"),b.stroke(g||"#0000"),b.rect(c[0]-d[0],c[1]-
d[1],c[2]+d[0]+d[2],c[3]+d[1]+d[3]);Tilt.UI.debug&&(b.fill("#fff2"),b.stroke("#00f"),b.rect(this.$sprite.$x,this.$sprite.$y,this.$sprite.$width,this.$sprite.$height),this.disabled||(b.fill("#0f04"),b.rect(this.$bounds[0],this.$bounds[1],this.$bounds[2],this.$bounds[3])))},destroy:function(){Tilt.destroyObject(this)}};Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.Slider"];
Tilt.Slider=function(a,b){Tilt.Profiler.intercept("Tilt.Slider",this);b=b||{};this.hidden=b.hidden||!1;this.disabled=b.disabled||!1;this.onmousedown=b.onmousedown||void 0;this.onmouseup=b.onmouseup||void 0;this.onclick=b.onclick||void 0;this.$sprite=new Tilt.Sprite(a.$texture,a.$region,{padding:a.$padding,tint:a.$tint});this.$sprite.$x=b.x||this.$sprite.$x;this.$sprite.$y=b.y||this.$sprite.$y;this.$sprite.$width=b.width||this.$sprite.$width;this.$sprite.$height=b.height||this.$sprite.$height;this.$x=
this.$sprite.$x;this.$y=this.$sprite.$y;this.$size=b.size||100;this.$direction=b.direction||0;this.$bounds=[this.$sprite.$x+this.$sprite.$padding[0],this.$sprite.$y+this.$sprite.$padding[1],this.$sprite.$width-this.$sprite.$padding[2],this.$sprite.$height-this.$sprite.$padding[3]];this.setValue(b.value||0)};
Tilt.Slider.prototype={setPosition:function(a,b){this.$x=a;this.$y=b;this.$bounds[0]=a+this.$sprite.$padding[0];this.$bounds[1]=b+this.$sprite.$padding[1];this.setValue(this.$value)},setX:function(a){this.setPosition(a,this.$y);this.setValue(this.$value)},setY:function(a){this.setPosition(this.$x,a);this.setValue(this.$value)},setSize:function(a){this.$size=a;this.setValue(this.$value)},setValue:function(a){var b=this.$sprite,c=this.$x,d=this.$y,f=this.$size,g=this.$direction;this.$value=Tilt.Math.clamp(a+
0.0010,0,100);g===0?(a=Tilt.Math.map(this.$value,0,100,c,c+f),b.setPosition(a,d),this.$bounds[0]=a+b.$padding[0]):(a=Tilt.Math.map(this.$value,0,100,d,d+f),b.setPosition(c,a),this.$bounds[1]=a+b.$padding[1])},getX:function(){return this.$x},getY:function(){return this.$y},getSize:function(){return this.$size},getValue:function(){return this.$value},update:function(){var a=Tilt.UI,b,c,d,f,g,h,i;if(this.mousePressed)this.$sliding=!0;else if(!a.mousePressed)this.$sliding=!1;if(this.$sliding)b=this.$sprite,
c=this.$parentX,d=this.$parentY,f=this.$x,g=this.$y,h=this.$size,i=this.$direction,i===0?(f+=c,h=f+h,a=Tilt.Math.clamp(a.mouseX-b.$width*0.5,f,h),c=a-c,b.setPosition(c,g),this.$value=Tilt.Math.map(a,f,h,0,100),this.$bounds[0]=c+b.$padding[0]):(g+=d,a=Tilt.Math.clamp(a.$mouseY-b.$height*0.5,g,g+h),c=a-d,b.setPosition(f,c),this.$value=Tilt.Math.map(c,g,g+h,0,100),this.$bounds[1]=c+b.$padding[1])},draw:function(a,b){b=b||Tilt.$renderer;this.$sprite.draw(b)},destroy:function(){Tilt.destroyObject(this)}};
Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.Sprite"];
Tilt.Sprite=function(a,b,c){Tilt.Profiler.intercept("Tilt.Sprite",this);c=c||{};this.hidden=c.hidden||!1;this.disabled=c.disabled||!1;this.onmousedown=c.onmousedown||void 0;this.onmouseup=c.onmouseup||void 0;this.onclick=c.onclick||void 0;this.$texture=a;this.$region=b||[0,0,a.width,a.height];this.$x=c.x||0;this.$y=c.y||0;this.$width=c.width||this.$region[2];this.$height=c.height||this.$region[3];this.$padding=c.padding||[0,0,0,0];this.$tint=c.tint||null;this.$depthTest=c.depthTest||!1;this.$bounds=
[this.$x+this.$padding[0],this.$y+this.$padding[1],this.$width-this.$padding[0]-this.$padding[2],this.$height-this.$padding[0]-this.$padding[3]];this.$texCoord=null};
Tilt.Sprite.prototype={setPosition:function(a,b){this.$x=a;this.$y=b;this.$bounds[0]=a+this.$padding[0];this.$bounds[1]=b+this.$padding[1]},setSize:function(a,b){this.$width=a;this.$height=b;this.$bounds[2]=a-this.$padding[0]-this.$padding[2];this.$bounds[3]=b-this.$padding[1]-this.$padding[3]},setX:function(a){this.setPosition(a,this.$y)},setY:function(a){this.setPosition(this.$x,a)},setWidth:function(a){this.setSize(a,this.$height)},setHeight:function(a){this.setSize(this.$width,a)},getX:function(){return this.$x},
getY:function(){return this.$y},getWidth:function(){return this.$width},getHeight:function(){return this.$height},draw:function(a,b){var b=b||Tilt.$renderer,c=this.$region,d=this.$texture,f=this.$x,g=this.$y,h=this.$width,i=this.$height,k=this.$depthTest,l=this.$tint;if(this.$texCoord===null&&d.loaded)this.$texCoord=new Tilt.VertexBuffer([c[0]/d.width,c[1]/d.height,(c[0]+c[2])/d.width,c[1]/d.height,c[0]/d.width,(c[1]+c[3])/d.height,(c[0]+c[2])/d.width,(c[1]+c[3])/d.height],2);l!==null&&b.tint(l);
k?(b.depthTest(!0),b.image(d,f,g,h,i,this.$texCoord),b.depthTest(!1)):b.image(d,f,g,h,i,this.$texCoord);l!==null&&b.tint("#fff");Tilt.UI.debug&&(b.fill("#fff2"),b.stroke("#f00"),b.rect(this.$x,this.$y,this.$width,this.$height),this.disabled||(b.fill("#0f04"),b.rect(this.$bounds[0],this.$bounds[1],this.$bounds[2],this.$bounds[3])))},destroy:function(){Tilt.destroyObject(this)}};Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.UI"];Tilt.UI=[];Tilt.UI.mouseX=0;Tilt.UI.mouseY=0;Tilt.UI.mousePressed=!1;
Tilt.UI.mouseOver=!1;Tilt.UI.mouseScrollAmmount=0;Tilt.UI.keyPressed=[];Tilt.UI.requestRedraw=function(){};Tilt.UI.draw=function(a){var b=Tilt.$renderer,c,d,f;b.defaults();b.ortho();for(c=0,d=this.length;c<d;c++)f=this[c],f.hidden||(f.disabled||f.update(a,b),f.draw(a,b))};Tilt.UI.presentModal=function(a){if(!(a.modal||this.indexOf(a)===-1)){for(var b=0,c=this.length;b<c;b++)this[b].$prevDisabled=this[b].disabled,this[b].disabled=!0;a.modal=!0;a.hidden=!1;a.disabled=!1;this.requestRedraw()}};
Tilt.UI.dismissModal=function(a){if(a.modal&&this.indexOf(a)!==-1){for(var b=0,c=this.length;b<c;b++)this[b].disabled=this[b].$prevDisabled,delete this[b].$prevDisabled;a.modal=!1;a.hidden=!0;a.disabled=!0;this.requestRedraw()}};Tilt.UI.mouseDown=function(a,b,c){this.mousePressed=!0;this.mouseOver=!1;this.$handleMouseEvent("onmousedown",a,b,c)};Tilt.UI.mouseUp=function(a,b,c){this.mouseOver=this.mousePressed=!1;this.$handleMouseEvent("onmouseup",a,b,c)};
Tilt.UI.click=function(a,b){this.$handleMouseEvent("onclick",a,b)};Tilt.UI.doubleClick=function(a,b){this.$handleMouseEvent("ondoubleclick",a,b)};Tilt.UI.mouseMove=function(a,b){this.mouseX=a;this.mouseY=b};Tilt.UI.mouseScroll=function(a){this.mouseOver=!1;this.mouseScrollAmmount=a;this.$handleMouseEvent("onmousescroll",a)};Tilt.UI.mouseOver=function(){};Tilt.UI.mouseOut=function(){};Tilt.UI.keyDown=function(a){this.keyPressed[a]=!0;this.$handleKeyEvent("onkeydown",a)};
Tilt.UI.keyUp=function(a){this.keyPressed[a]=!1;this.$handleKeyEvent("onkeyup",a)};Tilt.UI.windowFocus=function(){this.mouseX=-Number.MAX_VALUE;this.mouseY=-Number.MAX_VALUE};
Tilt.UI.$handleMouseEvent=function(a,b,c,d){var f,g,h,i,k,l,m,j,q,t,s,x,r=this.mouseX,o=this.mouseY;for(f=0,h=this.length;f<h;f++)if(k=this[f],!k.hidden&&!k.disabled){j=k.$x||0;g=k.$y||0;i=k.$width||0;q=k.$height||0;if(k.standby&&r>j&&r<j+i&&o>g&&o<g+q)this.mouseOver=!0,m=k[a],"function"===typeof m&&m(b,c,d);i=k.$offset||[0,0];j+=i[0];q=g+i[1]+2;for(g=0,i=k.length;g<i;g++)if((l=k[g])&&!l.hidden&&!l.disabled&&l.drawable){t=l.$bounds||[-1,-1,-1,-1];m=t[0]+j;s=t[1]+q;x=t[2];t=t[3];if("onmouseup"===a)l.mousePressed=
!1;if(r>m&&r<m+x&&o>s&&o<s+t){if("onmousedown"===a)l.mousePressed=!0;this.mouseOver=!0;m=l[a];"function"===typeof m&&m(b,c,d)}}}};Tilt.UI.$handleKeyEvent=function(a,b){var c,d,f,g,h,i,k;for(c=0,f=this.length;c<f;c++)if(h=this[c],!h.hidden&&!h.disabled){h.standby&&(k=h[a],"function"===typeof k&&k(b));for(d=0,g=h.length;d<g;d++)if((i=h[d])&&!i.hidden&&!i.disabled)k=i[a],"function"===typeof k&&k(b)}};Tilt.Profiler.intercept("Tilt.UI",Tilt.UI);if("undefined"===typeof Cc)var Cc=Components.classes;
if("undefined"===typeof Ci)var Ci=Components.interfaces;if("undefined"===typeof Cu)var Cu=Components.utils;Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.Console","Tilt.StringBundle"];
Tilt.Console={alert:function(a,b){var c;"undefined"===typeof b&&(b="undefined");try{c=Cc["@mozilla.org/embedcomp/prompt-service;1"].getService(Ci.nsIPromptService),c.alert(null,a,b)}catch(d){window.alert(b)}},log:function(a){var b;"undefined"===typeof a&&(a="undefined");try{b=Cc["@mozilla.org/consoleservice;1"].getService(Ci.nsIConsoleService),b.logStringMessage(a)}catch(c){window.alert(a)}},error:function(a,b,c,d,f,g,h){var i,k;"undefined"===typeof a&&(a="undefined");try{i=Cc["@mozilla.org/consoleservice;1"].getService(Ci.nsIConsoleService),
k=Cc["@mozilla.org/scripterror;1"].createInstance(Ci.nsIScriptError),k.init(a,b,c,d,f,g,h),i.logMessage(k)}catch(l){window.alert(a)}}};Tilt.StringBundle={bundle:"tilt-string-bundle",get:function(a){if("undefined"===typeof a)return"undefined";var b=document.getElementById(this.bundle);return b?b.getString(a):a},format:function(a,b){if("undefined"===typeof a)return"undefined";if("undefined"===typeof b)return a;var c=document.getElementById(this.bundle);return c?c.getFormattedString(a,b):[a,b].join(" ")}};
Tilt.bindObjectFunc(Tilt.Console);Tilt.Profiler.intercept("Tilt.Console",Tilt.Console);Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.Document"];
Tilt.Document={currentContentDocument:void 0,currentParentNode:void 0,initCanvas:function(a,b,c,d){if("undefined"===typeof this.currentContentDocument)this.currentContentDocument=document;if("undefined"===typeof this.currentParentNode)this.currentParentNode=document.body;var f=this.currentContentDocument,g=this.currentParentNode;if("undefined"===typeof f||f===null||"undefined"===typeof g||g===null)return null;f=f.createElement("canvas");f.setAttribute("style","width: 100%; height: 100%;");f.width=
a;f.height=b;f.id=d;c&&this.append(f,g);return f},initFullScreenCanvas:function(){var a=this.initCanvas(window.innerWidth,window.innerHeight,!0);this.currentParentNode.setAttribute("style","background: #000; margin: 0px; padding: 0px; overflow: hidden;");return a},append:function(a,b){b.appendChild(a)},remove:function(a){a.parentNode.removeChild(a)},traverse:function(a,b,c,d){this.offsetY=this.offsetX=this.uid=0;this.sliceHeight=this.sliceWidth=Number.MAX_VALUE;var f=0,g=0,h=function(b,d){var l,m,
j,q,t,s,x;for(l=0,m=b.childNodes.length;l<m;l++)if(j=b.childNodes[l],d>f&&(f=d),g++,this.uid++,a(j,d,g,this.uid,this.offsetX,this.offsetY,this.sliceWidth,this.sliceHeight),h(j,d+1),c&&j.localName==="iframe")q=Tilt.Document.getNodeCoordinates(j),t=q.x-window.content.pageXOffset,s=q.y-window.content.pageYOffset,x=q.width,q=q.height,this.offsetX+=t,this.offsetY+=s,this.sliceWidth=x,this.sliceHeight=q,h(j.contentDocument,d+1),this.offsetX-=t,this.offsetY-=s,this.sliceHeight=this.sliceWidth=Number.MAX_VALUE}.bind(this);
try{"function"===typeof a&&h(d||window.content.document,0),"function"===typeof b&&b(f,g)}finally{d=null}},getContentWindowDimensions:function(a){var b,c={width:a.innerWidth+a.scrollMaxX,height:a.innerHeight+a.scrollMaxY};this.traverse(function(a){b=this.getNodeCoordinates(a);c.width=Math.max(c.width,b.x||0+b.width||0);c.height=Math.max(c.height,b.y||0+b.height||0)}.bind(this),null,a.document);return c},getNodeCoordinates:function(a){if(a.nodeType!==1)return{x:0,y:0,width:0,height:0};var b,c,d,f;try{if(window.content.location.href===
"about:blank"&&(a.localName==="head"||a.localName==="body"))throw new Exception;d=a.getBoundingClientRect();b=window.content.pageXOffset;c=window.content.pageYOffset;return{x:d.left+b,y:d.top+c,width:d.width,height:d.height}}catch(g){c=b=0;d=a.clientWidth;f=a.clientHeight;if(a.offsetParent){do b+=a.offsetLeft,c+=a.offsetTop;while(a=a.offsetParent)}else{if(a.x)b=a.x;if(a.y)c=a.y}return{x:b,y:c,width:d,height:f}}finally{}},getNodeType:function(a){var b;a.nodeType===1?b="ELEMENT_NODE":a.nodeType===2?
b="ATTRIBUTE_NODE":a.nodeType===3?b="TEXT_NODE":a.nodeType===4?b="CDATA_SECTION_NODE":a.nodeType===5?b="ENTITY_REFERENCE_NODE":a.nodeType===6?b="ENTITY_NODE":a.nodeType===7?b="PROCESSING_INSTRUCTION_NODE":a.nodeType===8?b="COMMENT_NODE":a.nodeType===9?b="DOCUMENT_NODE":a.nodeType===10?b="DOCUMENT_TYPE_NODE":a.nodeType===11?b="DOCUMENT_FRAGMENT_NODE":a.nodeType===12&&(b="NOTATION_NODE");return b},getAttributesString:function(a){var b=[],c,d;for(c=0,d=a.length;c<d;c++)b.push(a[c].name+' = "'+a[c].value+
'"');return b.join("\n")+"\n"},getModifiedCss:function(a){var b=[],c,d,f;for(f=0;f<a.length;f++)c=a[f],d=a.getPropertyValue(c),c=c+": "+d+";",'background-attachment: scroll;\nbackground-clip: border-box;\nbackground-color: transparent;\nbackground-image: none;\nbackground-origin: padding-box;\nbackground-position: 0% 0%;\nbackground-repeat: repeat;\nbackground-size: auto auto;\nborder-bottom-color: rgb(0, 0, 0);\nborder-bottom-left-radius: 0px;\nborder-bottom-right-radius: 0px;\nborder-bottom-style: none;\nborder-bottom-width: 0px;\nborder-collapse: separate;\nborder-left-color: rgb(0, 0, 0);\nborder-left-style: none;\nborder-left-width: 0px;\nborder-right-color: rgb(0, 0, 0);\nborder-right-style: none;\nborder-right-width: 0px;\nborder-spacing: 0px 0px;\nborder-top-color: rgb(0, 0, 0);\nborder-top-left-radius: 0px;\nborder-top-right-radius: 0px;\nborder-top-style: none;\nborder-top-width: 0px;\nbottom: auto;\nbox-shadow: none;\ncaption-side: top;\nclear: none;\nclip: auto;\ncolor: rgb(0, 0, 0);\ncontent: none;\ncounter-increment: none;\ncounter-reset: none;\ncursor: auto;\ndirection: ltr;\ndisplay: block;\nempty-cells: -moz-show-background;\nfloat: none;\nfont-family: serif;\nfont-size: 16px;\nfont-size-adjust: none;\nfont-stretch: normal;\nfont-style: normal;\nfont-variant: normal;\nfont-weight: 400;\nheight: 0px;\nime-mode: auto;\nleft: auto;\nletter-spacing: normal;\nline-height: 19.2px;\nlist-style-image: none;\nlist-style-position: outside;\nlist-style-type: disc;\nmargin-bottom: 8px;\nmargin-left: 8px;\nmargin-right: 8px;\nmargin-top: 8px;\nmarker-offset: auto;\nmax-height: none;\nmax-width: none;\nmin-height: 0px;\nmin-width: 0px;\nopacity: 1;\noutline-color: rgb(0, 0, 0);\noutline-offset: 0px;\noutline-style: none;\noutline-width: 0px;\noverflow: visible;\noverflow-x: visible;\noverflow-y: visible;\npadding-bottom: 0px;\npadding-left: 0px;\npadding-right: 0px;\npadding-top: 0px;\npage-break-after: auto;\npage-break-before: auto;\npointer-events: auto;\nposition: static;\nquotes: "\u201c" "\u201d" "\u2018" "\u2019";\nresize: none;\nright: auto;\ntable-layout: auto;\ntext-align: start;\ntext-decoration: none;\ntext-indent: 0px;\ntext-overflow: clip;\ntext-shadow: none;\ntext-transform: none;\ntop: auto;\nunicode-bidi: embed;\nvertical-align: baseline;\nvisibility: visible;\nwhite-space: normal;\nwidth: 1157px;\nword-spacing: 0px;\nword-wrap: normal;\nz-index: auto;\n-moz-animation-delay: 0s;\n-moz-animation-direction: normal;\n-moz-animation-duration: 0s;\n-moz-animation-fill-mode: none;\n-moz-animation-iteration-count: 1;\n-moz-animation-name: none;\n-moz-animation-play-state: running;\n-moz-animation-timing-function: cubic-bezier(0.25, 0.1, 0.25, 1);\n-moz-appearance: none;\n-moz-background-inline-policy: continuous;\n-moz-binding: none;\n-moz-border-bottom-colors: none;\n-moz-border-image: none;\n-moz-border-left-colors: none;\n-moz-border-right-colors: none;\n-moz-border-top-colors: none;\n-moz-box-align: stretch;\n-moz-box-direction: normal;\n-moz-box-flex: 0;\n-moz-box-ordinal-group: 1;\n-moz-box-orient: horizontal;\n-moz-box-pack: start;\n-moz-box-sizing: content-box;\n-moz-column-count: auto;\n-moz-column-gap: 16px;\n-moz-column-rule-color: rgb(0, 0, 0);\n-moz-column-rule-style: none;\n-moz-column-rule-width: 0px;\n-moz-column-width: auto;\n-moz-float-edge: content-box;\n-moz-font-feature-settings: normal;\n-moz-font-language-override: normal;\n-moz-force-broken-image-icon: 0;\n-moz-hyphens: manual;\n-moz-image-region: auto;\n-moz-orient: horizontal;\n-moz-outline-radius-bottomleft: 0px;\n-moz-outline-radius-bottomright: 0px;\n-moz-outline-radius-topleft: 0px;\n-moz-outline-radius-topright: 0px;\n-moz-stack-sizing: stretch-to-fit;\n-moz-tab-size: 8;\n-moz-text-blink: none;\n-moz-text-decoration-color: rgb(0, 0, 0);\n-moz-text-decoration-line: none;\n-moz-text-decoration-style: solid;\n-moz-transform: none;\n-moz-transform-origin: 50% 50%;\n-moz-transition-delay: 0s;\n-moz-transition-duration: 0s;\n-moz-transition-property: all;\n-moz-transition-timing-function: cubic-bezier(0.25, 0.1, 0.25, 1);\n-moz-user-focus: none;\n-moz-user-input: auto;\n-moz-user-modify: read-only;\n-moz-user-select: auto;\n-moz-window-shadow: default;\nclip-path: none;\nclip-rule: nonzero;\ncolor-interpolation: srgb;\ncolor-interpolation-filters: linearrgb;\ndominant-baseline: auto;\nfill: rgb(0, 0, 0);\nfill-opacity: 1;\nfill-rule: nonzero;\nfilter: none;\nflood-color: rgb(0, 0, 0);\nflood-opacity: 1;\nimage-rendering: auto;\nlighting-color: rgb(255, 255, 255);\nmarker-end: none;\nmarker-mid: none;\nmarker-start: none;\nmask: none;\nshape-rendering: auto;\nstop-color: rgb(0, 0, 0);\nstop-opacity: 1;\nstroke: none;\nstroke-dasharray: none;\nstroke-dashoffset: 0px;\nstroke-linecap: butt;\nstroke-linejoin: miter;\nstroke-miterlimit: 4;\nstroke-opacity: 1;\nstroke-width: 1px;\ntext-anchor: start;\ntext-rendering: auto;'.indexOf(c)===
-1&&b.push(c);return b.join("\n")+"\n"}};Tilt.bindObjectFunc(Tilt.Document);Tilt.Profiler.intercept("Tilt.Document",Tilt.Document);Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.File"];
Tilt.File={showPicker:function(a,b){var c;try{return c=Cc["@mozilla.org/filepicker;1"].createInstance(Ci.nsIFilePicker),c.init(window,a,b==="folder"?Ci.nsIFilePicker.modeGetFolder:Ci.nsIFilePicker.modeOpen),c.show()==Ci.nsIFilePicker.returnOK?c.file:null}catch(d){return Tilt.Console.error(d.message),null}},save:function(a,b){var c,d,f,g;try{Cu.import("resource://gre/modules/FileUtils.jsm"),Cu.import("resource://gre/modules/NetUtil.jsm"),c=Cc["@mozilla.org/file/local;1"].createInstance(Ci.nsILocalFile),
c.initWithPath(b),d=FileUtils.openSafeFileOutputStream(c),g=Cc["@mozilla.org/intl/scriptableunicodeconverter"].createInstance(Ci.nsIScriptableUnicodeConverter),g.charset="UTF-8",f=g.convertToInputStream(a),NetUtil.asyncCopy(f,d,function(a){return Components.isSuccessCode(a)?!1:!0})}catch(h){return Tilt.Console.error(h.message),!1}},saveImage:function(a,b){var c,d,f,g;try{return Cu.import("resource://gre/modules/FileUtils.jsm"),Cu.import("resource://gre/modules/NetUtil.jsm"),c=Cc["@mozilla.org/file/local;1"].createInstance(Ci.nsILocalFile),
c.initWithPath(b),d=Cc["@mozilla.org/network/io-service;1"].getService(Ci.nsIIOService),f=d.newURI(a.toDataURL("image/png",""),"UTF8",null),d.newFileURI(c),g=Cc["@mozilla.org/embedding/browser/nsWebBrowserPersist;1"].createInstance(Ci.nsIWebBrowserPersist),g.persistFlags=Ci.nsIWebBrowserPersist.PERSIST_FLAGS_REPLACE_EXISTING_FILES,g.persistFlags|=Ci.nsIWebBrowserPersist.PERSIST_FLAGS_AUTODETECT_APPLY_CONVERSION,g.saveURI(f,null,null,null,null,c),!0}catch(h){return Tilt.Console.error(h.message),!1}},
separator:function(){return navigator.appVersion.indexOf("Win")!==-1?"\\":(navigator.appVersion.indexOf("Mac")===-1&&navigator.appVersion.indexOf("X11")===-1&&navigator.appVersion.indexOf("Linux"),"/")}()};Tilt.bindObjectFunc(Tilt.File);Tilt.Profiler.intercept("Tilt.File",Tilt.File);Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.Math"];
Tilt.Math={radians:function(a){return a*0.0174532925},degrees:function(a){return a*57.2957795},map:function(a,b,c,d,f){return d+(f-d)*((a-b)/(c-b))},isPowerOfTwo:function(a){return(a&a-1)===0},nextPowerOfTwo:function(a){var b;--a;for(b=1;b<32;b<<=1)a|=a>>b;return a+1},clamp:function(a,b,c){if(b>c)var d=b,b=c,c=d;return Math.max(b,Math.min(c,a))},quat4fromAxis:function(a,b,c){b*=0.5;var d=Math.sin(b),b=Math.cos(b),f=a[0]*d,g=a[1]*d,a=a[2]*d;return"undefined"===typeof c?[f,g,a,b]:(c[0]=f,c[1]=g,c[2]=
a,c[3]=b,c)},quat4fromEuler:function(a,b,c,d){var f;b*=0.5;a*=0.5;c*=0.5;var g=Math.sin,h=Math.cos;f=g(b);var i=g(a),g=g(c),k=h(b),l=h(a),h=h(c),b=f*l*h-k*i*g,a=k*i*h+f*l*g,c=k*l*g-f*i*h;f=k*l*h+f*i*g;return"undefined"===typeof d?[b,a,c,f]:(d[0]=b,d[1]=a,d[2]=c,d[3]=f,d)},project:function(a,b,c,d,f){var g,h=quat4.create();d?mat4.multiply(d,c,g=mat4.create()):g=c;a[3]=1;mat4.multiplyVec4(g,a,h);d?(f[0]=h[0]/h[3],f[1]=h[1]/h[3],f[0]*=b[2]*0.5,f[1]*=-b[3]*0.5,f[0]+=b[2]*0.5,f[1]+=b[3]*0.5,f[2]=0):(f[0]=
h[0],f[1]=h[1],f[2]=h[2]);return f},unproject:function(a,b,c,d,f){var g=mat4.create(),f=f||quat4.create();mat4.multiply(d,c,g);mat4.inverse(g);f[0]=+((a[0]-b[0])/b[2]*2-1);f[1]=-((a[1]-b[1])/b[3]*2-1);f[2]=2*a[2]-1;f[3]=1;mat4.multiplyVec4(g,f);f[3]=1/f[3];f[0]*=f[3];f[1]*=f[3];f[2]*=f[3];return f},createRay:function(a,b,c,d,f){this.unproject(a,c,d,f,a);this.unproject(b,c,d,f,b);return{position:a,lookAt:b,direction:vec3.normalize(vec3.subtract(b,a))}},intersectRayTriangle:function(a,b,c,d,f){var g=
vec3.create(),h=vec3.create(),i=vec3.create(),k=vec3.create(),l=vec3.create(),m=d.position,d=d.direction;"undefined"===typeof f&&(f=vec3.create());vec3.subtract(b,a,g);vec3.subtract(c,a,h);vec3.cross(g,h,i);if(i[0]===0&&i[1]===0&&i[2]===0)return-1;vec3.subtract(m,a,l);b=-vec3.dot(i,l);i=+vec3.dot(i,d);if(Math.abs(i)<1.0E-4)return b===0?2:0;i=b/i;if(i<0)return 0;vec3.add(m,vec3.scale(d,i),f);m=vec3.dot(g,g);d=vec3.dot(g,h);i=vec3.dot(h,h);vec3.subtract(f,a,k);a=vec3.dot(k,g);h=vec3.dot(k,h);k=d*d-
m*i;f=(d*h-i*a)/k;if(f<0||f>1)return 0;h=(d*a-m*h)/k;return h<0||f+h>1?0:1},hue2rgb:function(a,b,c){if(!(c<0)&&!(c>1))if(c<0.166666667)return a+(b-a)*6*c;else if(c<0.5)return b;else if(c<0.666666667)return a+(b-a)*(2/3-c)*6;return a},rgb2hsl:function(a,b,c){a*=0.00392156863;b*=0.00392156863;c*=0.00392156863;var d=Math.max(a,b,c),f=Math.min(a,b,c),g,h,i=(d+f)*0.5;d===f?h=f=0:(g=d-f,f=i>0.5?g/(2-d-f):g/(d+f),d===a?h=(b-c)/g+(b<c?6:0):d===b?h=(c-a)/g+2:d===c&&(h=(a-b)/g+4),h/=6);return[h,f,i]},hsl2rgb:function(a,
b,c){var d,f;b===0?c=b=a=c:(d=c<0.5?c*(1+b):c+b-c*b,f=2*c-d,c=this.hue2rgb(f,d,a+0.333333333),b=this.hue2rgb(f,d,a),a=this.hue2rgb(f,d,a-0.333333333));return[c*255,b*255,a*255]},rgb2hsv:function(a,b,c){a*=0.00392156863;b*=0.00392156863;c*=0.00392156863;var d=Math.max(a,b,c),f=Math.min(a,b,c),g,h;g=d-f;d===f?h=0:(d===a?h=(b-c)/g+(b<c?6:0):d===b?h=(c-a)/g+2:d===c&&(h=(a-b)/g+4),h/=6);return[h,d===0?0:g/d,d]},hsv2rgb:function(a,b,c){var d,f,g,h=Math.floor(a*6),i=a*6-h,a=c*(1-b),k=c*(1-i*b),b=c*(1-(1-
i)*b);h%=6;h===0?(d=c,f=b,g=a):h===1?(d=k,f=c,g=a):h===2?(d=a,f=c,g=b):h===3?(d=a,f=k,g=c):h===4?(d=b,f=a,g=c):h===5&&(d=c,f=a,g=k);return[d*255,f*255,g*255]},hex2rgba:function(a){var a=a.charAt(0)==="#"?a.substring(1):a,b,c,d,f;if("undefined"!==typeof this[a])return this[a];else b=window.parseInt(a,16);return a.length===3?this[a]=[((b&3840)>>8)*0.062745098,((b&240)>>4)*0.062745098,(b&15)*0.062745098,1]:a.length===4?this[a]=[((b&61440)>>12)*0.062745098,((b&3840)>>8)*0.062745098,((b&240)>>4)*0.062745098,
(b&15)*0.062745098]:a.length===6?this[a]=[((b&16711680)>>16)*0.00392156863,((b&65280)>>8)*0.00392156863,(b&255)*0.00392156863,1]:a.length===5?this[a]=[((b&983040)>>12)/255,((b&61440)>>8)/255,((b&3840)>>4)/255,(b&240)/255]:a.length===8?(b=parseInt(a.substring(0,2),16)*0.00392156863,c=parseInt(a.substring(2,4),16)*0.00392156863,d=parseInt(a.substring(4,6),16)*0.00392156863,f=parseInt(a.substring(6,8),16)*0.00392156863,this[a]=[b,c,d,f]):a.match("^rgba")=="rgba"?(b=a.substring(5,a.length-1).split(","),
b[0]*=0.00392156863,b[1]*=0.00392156863,b[2]*=0.00392156863,b[3]*=0.00392156863,this[a]=b):a.match("^rgb")=="rgb"?(b=a.substring(4,a.length-1).split(","),b[0]*=0.00392156863,b[1]*=0.00392156863,b[2]*=0.00392156863,b[3]=1,this[a]=b):this[a]=[0,0,0,1]}};Tilt.bindObjectFunc(Tilt.Math);Tilt.Profiler.intercept("Tilt.Math",Tilt.Math);Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.Preferences"];
Tilt.Preferences={get:function(a,b){var c;try{return c=Cc["@mozilla.org/preferences-service;1"].getService(Ci.nsIPrefService).getBranch(this.$branch),!c.prefHasUserValue(a)?void 0:b==="boolean"?c.getBoolPref(a):b==="string"?c.getCharPref(a):b==="integer"?c.getIntPref(a):null}catch(d){return Tilt.Console.error(d.message),null}},set:function(a,b,c){var d;try{return d=Cc["@mozilla.org/preferences-service;1"].getService(Ci.nsIPrefService).getBranch(this.$branch),b==="boolean"?d.setBoolPref(a,c):b==="string"?
d.setCharPref(a,c):b==="integer"?d.setIntPref(a,c):!1}catch(f){return Tilt.Console.error(f.message),!1}},create:function(a,b,c){var d;try{return d=Cc["@mozilla.org/preferences-service;1"].getService(Ci.nsIPrefService).getBranch(this.$branch),d.prefHasUserValue(a)?!1:b==="boolean"?d.setBoolPref(a,c):b==="string"?d.setCharPref(a,c):b==="integer"?d.setIntPref(a,c):!1}catch(f){return Tilt.Console.error(f.message),!1}},$branch:"extensions.tilt."};Tilt.bindObjectFunc(Tilt.Preferences);
Tilt.Profiler.intercept("Tilt.Preferences",Tilt.Preferences);Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.Random"];
Tilt.Random={$generator:null,next:function(){return this.$generator()},seed:function(){var a=0,b=0,c=0,d=1,f,g;if(arguments.length===0)return this.seed(+new Date);else{a=this.mash(" ");b=this.mash(" ");c=this.mash(" ");for(f=0;f<arguments.length;f++)a-=this.mash(arguments[f]),a<0&&(a+=1),b-=this.mash(arguments[f]),b<0&&(b+=1),c-=this.mash(arguments[f]),c<0&&(c+=1);g=function(){var f=2091639*a+d*2.3283064365386963E-10;a=b;b=c;return c=f-(d=f|0)};g.uint32=function(){return g()*4294967296};g.fract53=
function(){return g()+(g()*2097152|0)*1.1102230246251565E-16};return this.$generator=g}},mash:function(a){var b,c,d=4022871197,a=a.toString();for(b=0;b<a.length;b++)d+=a.charCodeAt(b),c=0.02519603282416938*d,d=c>>>0,c-=d,c*=d,d=c>>>0,c-=d,d+=c*4294967296;return(d>>>0)*2.3283064365386963E-10}};Tilt.bindObjectFunc(Tilt.Random);Tilt.Random.seed(0);Tilt.Profiler.intercept("Tilt.Random",Tilt.Random);Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.String"];
Tilt.String={trim:function(a){return a.replace(/^\s+|\s+$/g,"")},ltrim:function(a){return a.replace(/^\s+/,"")},rtrim:function(a){return a.replace(/\s+$/,"")}};Tilt.Profiler.intercept("Tilt.String",Tilt.String);Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.WebGL"];
Tilt.WebGL={initDocumentImage:function(a){var b,c,d,f;b=Tilt.Document.initCanvas();c=Tilt.Document.initCanvas();d=(b=Tilt.Renderer.prototype.create3DContext(b))?b.getParameter(b.MAX_TEXTURE_SIZE):0;if(d>0)f=Tilt.Document.getContentWindowDimensions(a),b=Tilt.Math.clamp(f.width,0,d),f=Tilt.Math.clamp(f.height,0,d),c.width=b,c.height=f,d=c.getContext("2d"),d.fillStyle="#fff",d.fillRect(0,0,c.width,c.height),d.drawWindow(a,0,0,b,f,"#fff");return c},refreshDocumentImage:function(a,b,c,d){var f=c.left,
g=c.top,h=c.width,i=c.height;if(d)return c=b.getContext("2d"),c.translate(f,g),c.drawWindow(a,f,g,h,i,"#fff"),c.translate(-f,-g),b;else if(this.$canvas)return this.$canvas.width=h,this.$canvas.height=i,c=this.$canvas.getContext("2d"),c.drawWindow(a,f,g,h,i,"#fff"),this.$canvas;else if("undefined"===typeof this.$canvas)return this.$canvas=Tilt.Document.initCanvas(),this.refreshDocumentImage(a,b,c);else this.$canvas=null,delete this.$canvas;return null}};Tilt.bindObjectFunc(Tilt.WebGL);
Tilt.Profiler.intercept("Tilt.WebGL",Tilt.WebGL);Tilt=Tilt||{};EXPORTED_SYMBOLS=["Tilt.Xhr"];Tilt.Xhr={request:function(a,b,c){var d=new XMLHttpRequest;d.open("GET",a,!0);d.send(null);d.onreadystatechange=function(){d.readyState===4&&"function"===typeof b&&b(d,c)}},requests:function(a,b,c){function d(d,h){f[h]=d;g++;g===a.length&&"function"===typeof b&&b(f,c)}var f=[],g=0,h,i;for(h=0,i=a.length;h<i;h++)this.request(a[h],d,h)}};Tilt.bindObjectFunc(Tilt.Xhr);Tilt.Profiler.intercept("Tilt.Xhr",Tilt.Xhr);
TiltChrome=TiltChrome||{};EXPORTED_SYMBOLS=["TiltChrome.Config.UI"];TiltChrome.Config={};
TiltChrome.Config.UI={viewMode:{initial:{hueSlider:{value:50},saturationSlider:{value:0},brightnessSlider:{value:100},alphaSlider:{value:80},textureSlider:{value:100},mesh:{outline:[0,0,0,0.25]}},normal:{hueSlider:{value:50},saturationSlider:{value:0},brightnessSlider:{value:100},alphaSlider:{value:80},textureSlider:{value:100},mesh:{outline:[0,0,0,0.25]}},wireframe:{hueSlider:{value:57.5},saturationSlider:{value:50},brightnessSlider:{value:100},alphaSlider:{value:7.5},textureSlider:{value:100},mesh:{outline:[1,
1,1,0.7]}}},domStrips:{stripButton:{stroke:"#fff3"},html:{fill:"#FFF"},"head/body":{fill:"#E667AF"},title:{fill:"#CD0074"},script:{fill:"#A64B00"},style:{fill:"#FF9640"},div:{fill:"#5DC8CD"},span:{fill:"#67E46F"},table:{fill:"#FF0700"},tr:{fill:"#FF4540"},td:{fill:"#FF7673"},ul:{fill:"#4671D5"},li:{fill:"#6C8CD5"},p:{fill:"#888"},a:{fill:"#123EAB"},img:{fill:"#FFB473"},iframe:{fill:"#85004B"},other:{fill:"#666"}}};
TiltChrome.Config.Visualization={refreshVisualization:null,sourceEditorTheme:null,hideUserInterfaceAtInit:null,disableMinidomAtInit:null,enableJoystick:null,useAccelerometer:null,escapeKeyCloses:null,keyShortcutOpenClose:null,reload:function(){this.refreshVisualization=Tilt.Preferences.get("options.refreshVisualization","integer");this.sourceEditorTheme=Tilt.Preferences.get("options.sourceEditorTheme","integer");this.hideUserInterfaceAtInit=Tilt.Preferences.get("options.hideUserInterfaceAtInit","boolean");
this.disableMinidomAtInit=Tilt.Preferences.get("options.disableMinidomAtInit","boolean");this.enableJoystick=Tilt.Preferences.get("options.enableJoystick","boolean");this.useAccelerometer=Tilt.Preferences.get("options.useAccelerometer","boolean");this.escapeKeyCloses=Tilt.Preferences.get("options.escapeKeyCloses","boolean");this.keyShortcutOpenClose=Tilt.Preferences.get("options.keyShortcutOpenClose","string")}};
TiltChrome.Config.Visualization.Set={refreshVisualization:function(a){Tilt.Preferences.set("options.refreshVisualization","integer",a)},sourceEditorTheme:function(a){Tilt.Preferences.set("options.sourceEditorTheme","integer",a)},hideUserInterfaceAtInit:function(a){Tilt.Preferences.set("options.hideUserInterfaceAtInit","boolean",a)},disableMinidomAtInit:function(a){Tilt.Preferences.set("options.disableMinidomAtInit","boolean",a)},enableJoystick:function(a){Tilt.Preferences.set("options.enableJoystick",
"boolean",a)},useAccelerometer:function(a){Tilt.Preferences.set("options.useAccelerometer","boolean",a)},escapeKeyCloses:function(a){Tilt.Preferences.set("options.escapeKeyCloses","boolean",a)},keyShortcutOpenClose:function(a){Tilt.Preferences.set("options.keyShortcutOpenClose","string",a)}};Tilt.bindObjectFunc(TiltChrome.Config.UI);Tilt.bindObjectFunc(TiltChrome.Config.Visualization);TiltChrome.Config.Visualization.reload();TiltChrome=TiltChrome||{};EXPORTED_SYMBOLS=["TiltChrome.Controller.MouseAndKeyboard"];
TiltChrome.Controller={};
TiltChrome.Controller.MouseAndKeyboard=function(){var a=Tilt.UI,b=null,c=0,d=0;this.init=function(a){if(a){b=new Tilt.Arcball(a.width,a.height,0,[-window.content.pageXOffset,-window.content.pageYOffset],[0,0]);this.stop=b.stop.bind(b);this.translate=b.translate.bind(b);this.rotate=b.rotate.bind(b);this.zoom=b.zoom.bind(b);this.reset=b.reset.bind(b);this.resize=b.resize.bind(b);a.addEventListener("mousedown",f,!1);a.addEventListener("mouseup",g,!1);a.addEventListener("click",h,!1);a.addEventListener("dblclick",
i,!1);a.addEventListener("mousemove",k,!1);a.addEventListener("mouseover",l,!1);a.addEventListener("mouseout",m,!1);a.addEventListener("MozMousePixelScroll",j,!1);window.addEventListener("keydown",q,!1);window.addEventListener("keyup",t,!1);window.addEventListener("focus",s,!0);var a=document.getElementById("urlbar"),c=document.getElementById("searchbar");"undefined"!==typeof a&&a!==null&&(a.addEventListener("focus",x,!1),a.addEventListener("blur",r,!1));"undefined"!==typeof c&&c!==null&&(c.addEventListener("focus",
x,!1),c.addEventListener("blur",r,!1))}};this.update=function(a){var c=this.visualization,a=b.loop(a);c.setRotation(a.rotation);c.setTranslation(a.translation)};var f=function(f){f.preventDefault();f.stopPropagation();c=f.clientX-f.target.offsetLeft;d=f.clientY-f.target.offsetTop;a.mouseDown(c,d,f.which);a.mouseOver?b.stop():b.mouseDown(c,d,f.which)},g=function(c){c.preventDefault();c.stopPropagation();var d=c.which,f=c.clientX-c.target.offsetLeft,c=c.clientY-c.target.offsetTop;a.mouseUp(f,c,d);b.mouseUp(f,
c,d)},h=function(b){b.preventDefault();b.stopPropagation();var f=b.which,g=b.clientX-b.target.offsetLeft,b=b.clientY-b.target.offsetTop;Math.abs(c-g)<2&&Math.abs(d-b)<2&&(a.click(g,b,f),a.mouseOver||this.visualization.performMeshPickHighlight(g,b));window.content.focus()}.bind(this),i=function(b){b.preventDefault();b.stopPropagation();var f=b.which,g=b.clientX-b.target.offsetLeft,b=b.clientY-b.target.offsetTop;Math.abs(c-g)<2&&Math.abs(d-b)<2&&(a.doubleClick(g,b,f),a.mouseOver||this.visualization.performMeshPickEdit(g,
b))}.bind(this),k=function(c){c.preventDefault();c.stopPropagation();var d=c.clientX-c.target.offsetLeft,c=c.clientY-c.target.offsetTop;a.mouseMove(d,c);b.mouseMove(d,c)},l=function(c){c.preventDefault();c.stopPropagation();a.mouseOut();b.mouseOut()},m=function(c){c.preventDefault();c.stopPropagation();a.mouseOut();b.mouseOut()},j=function(c){c.preventDefault();c.stopPropagation();a.mouseScroll(c.detail);a.mouseOver||b.mouseScroll(c.detail)},q=function(c){var d=c.keyCode||c.which;if(d>=37&&d<=40)c.preventDefault(),
c.stopPropagation();else try{if("open"===TiltChrome.BrowserOverlay.sourceEditor.panel.state||"open"===TiltChrome.BrowserOverlay.colorPicker.panel.state)return}catch(f){}!this.$browserBarFocus&&window.content.document.activeElement instanceof HTMLBodyElement&&(a.keyDown(d),b.keyDown(d))}.bind(this),t=function(c){var d=c.keyCode||c.which;if(d>=37&&d<=40)c.preventDefault(),c.stopPropagation();else if(d===27)try{if("open"===TiltChrome.BrowserOverlay.sourceEditor.panel.state)TiltChrome.BrowserOverlay.sourceEditor.panel.hidePopup();
else if("open"===TiltChrome.BrowserOverlay.colorPicker.panel.state)TiltChrome.BrowserOverlay.colorPicker.panel.hidePopup();else if(TiltChrome.Config.Visualization.escapeKeyCloses)TiltChrome.BrowserOverlay.destroy(!0,!0),TiltChrome.BrowserOverlay.href=null}catch(f){}this.$browserBarFocus||(a.keyUp(d),b.keyUp(d))}.bind(this),s=function(b){b.preventDefault();b.stopPropagation();a.windowFocus()},x=function(){this.$browserBarFocus=!0}.bind(this),r=function(){this.$browserBarFocus=!1}.bind(this);this.destroy=
function(o){a=this.visualization=null;if(o){f!==null&&(o.removeEventListener("mousedown",f,!1),f=null);g!==null&&(o.removeEventListener("mouseup",g,!1),g=null);h!==null&&(o.removeEventListener("click",h,!1),h=null);i!==null&&(o.removeEventListener("dblclick",i,!1),i=null);k!==null&&(o.removeEventListener("mousemove",k,!1),k=null);l!==null&&(o.removeEventListener("mouseover",l,!1),l=null);m!==null&&(o.removeEventListener("mouseout",m,!1),m=null);j!==null&&(o.removeEventListener("MozMousePixelScroll",
j,!1),j=null);q!==null&&(window.removeEventListener("keydown",q,!1),q=null);t!==null&&(window.removeEventListener("keyup",t,!1),t=null);s!==null&&(window.removeEventListener("focus",s,!0),s=null);var o=document.getElementById("urlbar"),w=document.getElementById("searchbar");x!==null&&(o&&o.removeEventListener("focus",x,!1),w&&w.removeEventListener("focus",x,!1),x=null);r!==null&&(o&&o.removeEventListener("focus",r,!1),w&&w.removeEventListener("focus",r,!1),r=null);b!==null&&(b.destroy(),b=null);d=
c=null;Tilt.destroyObject(this)}};Tilt.Profiler.intercept("TiltChrome.Controller.MouseAndKeyboard",this)};TiltChrome=TiltChrome||{};EXPORTED_SYMBOLS=["TiltChrome.Options"];
TiltChrome.Options={windowLoad:function(a,b){var c=TiltChrome.Config.Visualization,d=b.document,f=d.getElementById("tilt-options-refreshVisualizationCheckbox"),g=d.getElementById("tilt-options-refreshVisualizationRadiogroup"),h=d.getElementById("tilt-options-sourceEditorTheme"),i=d.getElementById("tilt-options-hideUserInterfaceAtInit"),k=d.getElementById("tilt-options-disableMinidomAtInit"),l=d.getElementById("tilt-options-enableJoystick"),m=d.getElementById("tilt-options-useAccelerometer"),j=d.getElementById("tilt-options-escapeKeyCloses"),
d=d.getElementById("tilt-options-keyShortcutOpenClose");c.refreshVisualization<=-1?(f.checked=!1,g.selectedIndex=-1):(f.checked=!0,g.selectedIndex=c.refreshVisualization);j.checked=c.escapeKeyCloses;h.selectedIndex=c.sourceEditorTheme;i.checked=c.hideUserInterfaceAtInit;k.checked=c.disableMinidomAtInit;l.checked=c.enableJoystick;m.checked=c.useAccelerometer;d.value=c.keyShortcutOpenClose;this.$openCloseTextboxValidate(d)},windowUnload:function(a,b){var c=TiltChrome.Config.Visualization.Set,d=b.document;
d.getElementById("tilt-options-refreshVisualizationCheckbox");var f=d.getElementById("tilt-options-refreshVisualizationRadiogroup"),g=d.getElementById("tilt-options-sourceEditorTheme"),h=d.getElementById("tilt-options-hideUserInterfaceAtInit"),i=d.getElementById("tilt-options-disableMinidomAtInit"),k=d.getElementById("tilt-options-enableJoystick"),l=d.getElementById("tilt-options-useAccelerometer"),m=d.getElementById("tilt-options-escapeKeyCloses"),d=d.getElementById("tilt-options-keyShortcutOpenClose");
c.refreshVisualization(f.selectedIndex);c.sourceEditorTheme(g.selectedIndex);c.escapeKeyCloses(m.checked);c.hideUserInterfaceAtInit(h.checked);c.disableMinidomAtInit(i.checked);c.enableJoystick(k.checked);c.useAccelerometer(l.checked);c.keyShortcutOpenClose(d.value.toUpperCase().replace(/\+/g," ").replace(/shift/i,"shift").replace(/control/i,"control").replace(/alt/i,"alt").replace(/command/i,"accel").replace(/space/i,"space").replace(/pgup/i,"pgup").replace(/pgdown/i,"pgdown").replace(/end/i,"end").replace(/home/i,
"home").replace(/left/i,"left").replace(/up/i,"up").replace(/right/i,"right").replace(/down/i,"down"))},windowKeyUp:function(a,b){(a.keyCode||a.which)===27&&b.close()},refreshVisualizationCheckboxPressed:function(a){var b=a.view.document;b.getElementById("tilt-options-refreshVisualizationCheckbox");b=b.getElementById("tilt-options-refreshVisualizationRadiogroup");a.target.checked?(b.selectedIndex=1,b.disabled=!1):(b.selectedIndex=-1,b.disabled=!0)},refreshFastestRadioPressed:function(){},refreshRecommendedRadioPressed:function(){},
refreshSlowestRadioPressed:function(){},hideUICheckboxPressed:function(){},disableMinidomCheckboxPressed:function(){},enableJoystickCheckboxPressed:function(){},useAccelerometerCheckboxPressed:function(){},escapeKeyCheckboxPressed:function(){},openCloseTextboxFocus:function(a){a.target.focused=!0},openCloseTextboxKeyDown:function(a){var b=a.keyCode||a.which;if(b!==27){if(a.target.focused)a.target.value="",a.target.focused=null,delete a.target.focused;if(b>=32&&b<=40||b>=65&&b<=90)a.preventDefault(),
a.stopPropagation();if(a.target.value.substr(-1)!=="+")a.target.value="";if(b===8||b===45||b===46)a.target.value="";b>=65&&b<=90&&(a.target.value+=String.fromCharCode(b));a.target.value.match(/shift/i)===null&&b===16&&(a.target.value+="shift+");a.target.value.match(/control/i)===null&&b===17&&(a.target.value+="control+");a.target.value.match(/alt/i)===null&&b===18&&(a.target.value+="alt+");a.target.value.match(/command/i)===null&&b===224&&(a.target.value+="command+");a.target.value.match(/space/i)===
null&&b===32&&(a.target.value+="space");a.target.value.match(/pgup/i)===null&&b===33&&(a.target.value+="pgup+");a.target.value.match(/pgdown/i)===null&&b===34&&(a.target.value+="pgdown+");a.target.value.match(/end/i)===null&&b===35&&(a.target.value+="end+");a.target.value.match(/home/i)===null&&b===36&&(a.target.value+="home+");a.target.value.match(/left/i)===null&&b===37&&(a.target.value+="left+");a.target.value.match(/up/i)===null&&b===38&&(a.target.value+="up+");a.target.value.match(/right/i)===
null&&b===39&&(a.target.value+="right+");a.target.value.match(/down/i)===null&&b===40&&(a.target.value+="down+");this.$openCloseTextboxValidate(a.target)}},openCloseResetButtonPressed:function(a){a=a.view.document.getElementById("tilt-options-keyShortcutOpenClose");a.value="accel+shift+M";this.$openCloseTextboxValidate(a)},$openCloseTextboxValidate:function(a){a.value=a.value.toUpperCase().replace(/\ /g,"+").replace(/shift/i,"Shift").replace(/control/i,"Control").replace(/alt/i,"Alt").replace(/command/i,
"Command").replace(/space/i,"Space").replace(/pgup/i,"PgUp").replace(/pgdown/i,"PgDown").replace(/end/i,"End").replace(/home/i,"Home").replace(/left/i,"Left").replace(/up/i,"Up").replace(/right/i,"Right").replace(/down/i,"Down").replace(/accel/i,function(){var a=navigator.appVersion;return a.indexOf("Win")!==-1?"Control":a.indexOf("Mac")!==-1?"Command":(a.indexOf("X11")===-1&&a.indexOf("Linux"),"Control")}())}};TiltChrome=TiltChrome||{};EXPORTED_SYMBOLS=["TiltChrome.UI.Default"];TiltChrome.UI={};
TiltChrome.UI.Default=function(){var a=Tilt.UI,b=TiltChrome.Config.UI,c=null,d=null,f=null,g=null,h=null,i=null,k=null,l=null,m=null,j=null,q=null,t=null,s=null,x=null,r=null,o=null,w=null,u=null,v=null,y=null,A=null,n=null,B=null,D=null,F=null,G=null,H=null,p=null,C=null,I=null,z=null,J=null,O=null,Q=null,N=null,L=null,T=null,R=null,U=null,V=null,$=null,S=null,K=null,E=null,X=null,Y=null,Z=null,ba=null,ca=null,da=null;this.init=function(P){if(P){i=new Tilt.Texture("chrome://tilt/skin/tilt-ui.png",
{minFilter:"nearest",magFilter:"nearest",onload:function(){this.visualization.requestRedraw()}.bind(this)});c=new Tilt.Container;d=new Tilt.Container;k=new Tilt.Sprite(i,[0,768,256,256],{width:P.width,height:P.height,depthTest:!0,disabled:!0});G=new Tilt.Button(new Tilt.Sprite(i,[935,120,42,38]),{x:P.width-50,y:-5,padding:[0,0,0,5],onclick:function(){TiltChrome.BrowserOverlay.destroy(!0,!0);TiltChrome.BrowserOverlay.href=null}});H=new Tilt.Button(new Tilt.Sprite(i,[935,80,46,38]),{x:P.width-150,y:-5,
padding:[0,0,0,5],onclick:function(){var b=P.width*0.5+197,c=P.height*0.5-218;ca.setPosition(P.width*0.5-305,P.height*0.5-305);da.setPosition(b,c);a.presentModal(f)}.bind(this)});p=new Tilt.Button(new Tilt.Sprite(i,[935,40,61,38]),{x:P.width-215,y:-5,padding:[0,0,0,5],onclick:function(){var a=Tilt.StringBundle.get("folderPicker.string"),b=Tilt.StringBundle.get("webpageFilename.string");if(a=Tilt.File.showPicker(a,"folder"))a.reveal(),this.visualization.performMeshSave(a.path,b)}.bind(this)});C=new Tilt.Button(new Tilt.Sprite(i,
[935,0,66,38]),{x:P.width-285,y:-5,padding:[0,0,0,5],onclick:function(){window.open("chrome://tilt/content/TiltChromeOptions.xul","Options","chrome, modal, centerscreen, width=410, height=350");TiltChrome.Config.Visualization.reload();TiltChrome.EntryPoint.refreshKeyset()}.bind(this)});z=new Tilt.Button(new Tilt.Sprite(i,[935,200,48,38]),{x:P.width-337,y:-5,padding:[0,0,0,5],hidden:!0,onclick:function(){this.visualization.setHtmlEditor()}.bind(this)});J=new Tilt.Button(new Tilt.Sprite(i,[935,160,
36,38]),{x:P.width-377,y:-5,padding:[0,0,0,5],hidden:!0,onclick:function(){this.visualization.setCssEditor()}.bind(this)});I=new Tilt.Button(new Tilt.Sprite(i,[935,240,84,38]),{x:P.width-465,y:-5,padding:[0,0,0,5],hidden:!0,onclick:function(){this.visualization.setAttributesEditor()}.bind(this)});O=new Tilt.Button(new Tilt.Sprite(i,[0,147,42,42]),{x:0,y:-5,padding:[6,6,6,6],onclick:function(){window.clearInterval(this.$arcballMove);this.$arcballTranslation=0;this.$arcballMove=window.setInterval(function(){this.$arcballTranslation++;
this.controller.translate(h.view.hidden?-5:5,0);this.$arcballTranslation>=20&&window.clearInterval(this.$arcballMove)}.bind(this),1E3/60);d.hidden^=1;h.view.hidden^=1;if(!f.hidden)f.hidden=!0;if(!g.hidden)g.hidden=!0}.bind(this)});Q=new Tilt.Sprite(i,[0,0,145,145],{x:0,y:0,disabled:!0});N=new Tilt.Button(null,{x:50,y:4,width:45,height:30,onmousedown:function(){window.clearInterval(this.$arcballMove);this.$arcballMove=window.setInterval(function(){this.controller.translate(0,-5);a.mousePressed||window.clearInterval(this.$arcballMove)}.bind(this),
1E3/60)}.bind(this)});L=new Tilt.Button(null,{x:50,y:110,width:45,height:30,onmousedown:function(){window.clearInterval(this.$arcballMove);this.$arcballMove=window.setInterval(function(){this.controller.translate(0,5);a.mousePressed||window.clearInterval(this.$arcballMove)}.bind(this),1E3/60)}.bind(this)});T=new Tilt.Button(null,{x:4,y:50,width:30,height:45,onmousedown:function(){window.clearInterval(this.$arcballMove);this.$arcballMove=window.setInterval(function(){this.controller.translate(-5,0);
a.mousePressed||window.clearInterval(this.$arcballMove)}.bind(this),1E3/60)}.bind(this)});R=new Tilt.Button(null,{x:110,y:50,width:30,height:45,onmousedown:function(){window.clearInterval(this.$arcballMove);this.$arcballMove=window.setInterval(function(){this.controller.translate(5,0);a.mousePressed||window.clearInterval(this.$arcballMove)}.bind(this),1E3/60)}.bind(this)});U=new Tilt.Button(new Tilt.Sprite(i,[0,190,42,42]),{x:50,y:135,padding:[6,6,6,6],onclick:function(){this.controller.reset(0.95)}.bind(this)});
V=new Tilt.Button(new Tilt.Sprite(i,[0,234,42,42]),{x:90,y:U.getY(),padding:[6,6,6,6],onclick:function(){this.controller.zoom(200)}.bind(this)});$=new Tilt.Button(new Tilt.Sprite(i,[0,278,42,42]),{x:10,y:U.getY(),padding:[6,6,6,6],onclick:function(){this.controller.zoom(-200)}.bind(this)});l=new Tilt.Sprite(i,[1,324,89,354],{x:0,y:293,disabled:!0});h=new Tilt.ScrollContainer({x:85,y:300,width:130,height:P.height-310,background:"#0001",scrollable:[0,Math.MAX_VALUE],top:new Tilt.Sprite(i,[45,222,33,
30],{padding:[2,2,2,4]}),bottom:new Tilt.Sprite(i,[45,255,33,30],{padding:[2,2,2,4]}),reset:new Tilt.Sprite(i,[45,289,33,30],{padding:[2,4,2,2]})});m=new Tilt.Button(null,{x:5,y:301,width:14,height:14,fill:b.domStrips.html.fill,onclick:function(){M(b.domStrips.html,m)}});j=new Tilt.Button(null,{x:5,y:m.getY()+20,width:14,height:14,fill:b.domStrips["head/body"].fill,onclick:function(){M(b.domStrips["head/body"],j)}});q=new Tilt.Button(null,{x:5,y:j.getY()+20,width:14,height:14,fill:b.domStrips.title.fill,
onclick:function(){M(b.domStrips.title,q)}});t=new Tilt.Button(null,{x:5,y:q.getY()+20,width:14,height:14,fill:b.domStrips.style.fill,onclick:function(){M(b.domStrips.style,t)}});s=new Tilt.Button(null,{x:5,y:t.getY()+20,width:14,height:14,fill:b.domStrips.script.fill,onclick:function(){M(b.domStrips.script,s)}});x=new Tilt.Button(null,{x:5,y:s.getY()+20,width:14,height:14,fill:b.domStrips.div.fill,onclick:function(){M(b.domStrips.div,x)}});r=new Tilt.Button(null,{x:5,y:x.getY()+20,width:14,height:14,
fill:b.domStrips.span.fill,onclick:function(){M(b.domStrips.span,r)}});o=new Tilt.Button(null,{x:5,y:r.getY()+20,width:14,height:14,fill:b.domStrips.table.fill,onclick:function(){M(b.domStrips.table,o)}});w=new Tilt.Button(null,{x:5,y:o.getY()+20,width:14,height:14,fill:b.domStrips.tr.fill,onclick:function(){M(b.domStrips.tr,w)}});u=new Tilt.Button(null,{x:5,y:w.getY()+20,width:14,height:14,fill:b.domStrips.td.fill,onclick:function(){M(b.domStrips.td,u)}});v=new Tilt.Button(null,{x:5,y:u.getY()+20,
width:14,height:14,fill:b.domStrips.ul.fill,onclick:function(){M(b.domStrips.ul,v)}});y=new Tilt.Button(null,{x:5,y:v.getY()+20,width:14,height:14,fill:b.domStrips.li.fill,onclick:function(){M(b.domStrips.li,y)}});A=new Tilt.Button(null,{x:5,y:y.getY()+20,width:14,height:14,fill:b.domStrips.p.fill,onclick:function(){M(b.domStrips.p,A)}});n=new Tilt.Button(null,{x:5,y:A.getY()+20,width:14,height:14,fill:b.domStrips.a.fill,onclick:function(){M(b.domStrips.a,n)}});B=new Tilt.Button(null,{x:5,y:n.getY()+
20,width:14,height:14,fill:b.domStrips.img.fill,onclick:function(){M(b.domStrips.img,B)}});D=new Tilt.Button(null,{x:5,y:B.getY()+20,width:14,height:14,fill:b.domStrips.iframe.fill,onclick:function(){M(b.domStrips.iframe,D)}});F=new Tilt.Button(null,{x:5,y:D.getY()+20,width:14,height:14,fill:b.domStrips.other.fill,onclick:function(){M(b.domStrips.other,F)}});var M=function(a,b){this.$colorPickerConfig=a;this.$colorPickerButton=b;var c=TiltChrome.BrowserOverlay.colorPicker,d=Tilt.Math.hex2rgba(a.fill),
d=Tilt.Math.rgb2hsv(d[0]*255,d[1]*255,d[2]*255);c.refresh(d[0]*360,d[1]*100,d[2]*100);c.panel.openPopup(null,null,200+b.getX(),80+b.getY())}.bind(this),fa=new Tilt.Sprite(i,[438,67,66,66]),ea=new Tilt.Sprite(i,[438,0,66,66]);S=new Tilt.Button(ea,{x:39,y:170,padding:[12,10,12,12],onclick:function(){if(S.type!==1){S.type=1;S.setSprite(fa);var a=b.viewMode.wireframe}else S.type=0,S.setSprite(ea),a=b.viewMode.normal;E.setValue(a.hueSlider.value);X.setValue(a.saturationSlider.value);Y.setValue(a.brightnessSlider.value);
Z.setValue(a.alphaSlider.value);ba.setValue(a.textureSlider.value);aa();this.visualization.setMeshWireframeColor(a.mesh.outline)}.bind(this)});K=new Tilt.Button(new Tilt.Sprite(i,[505,0,66,66]),{x:39,y:230,padding:[12,10,14,16],onclick:function(){g.hidden^=1;this.visualization.requestRedraw()}.bind(this)});var W=new Tilt.Sprite(i,[574,131,29,29],{padding:[8,8,8,8]});E=new Tilt.Slider(W,{x:64,y:12,size:120,value:b.viewMode.initial.hueSlider.value,onmousedown:function(){aa()}});X=new Tilt.Slider(W,
{x:E.getX(),y:E.getY()+19,size:120,value:b.viewMode.initial.saturationSlider.value,onmousedown:function(){aa()}});Y=new Tilt.Slider(W,{x:E.getX(),y:X.getY()+18,size:120,value:b.viewMode.initial.brightnessSlider.value,onmousedown:function(){aa()}});Z=new Tilt.Slider(W,{x:E.getX(),y:Y.getY()+18,size:120,value:b.viewMode.initial.alphaSlider.value,onmousedown:function(){aa()}});ba=new Tilt.Slider(W,{x:E.getX(),y:Z.getY()+18,size:120,value:b.viewMode.initial.textureSlider.value,onmousedown:function(){aa()}});
var aa=function(){window.clearInterval(this.$sliderMove);this.$sliderMove=window.setInterval(function(){var b=Tilt.Math.hsv2rgb(E.getValue()*0.01,X.getValue()*0.01,Y.getValue()*0.01),c=ba.getValue()*0.01;b[0]/=255;b[1]/=255;b[2]/=255;b[3]=Z.getValue()*0.01;this.visualization.setMeshColor(b);this.visualization.setMeshTextureAlpha(c);a.mousePressed||window.clearInterval(this.$sliderMove)}.bind(this),1E3/60)}.bind(this),W=new Tilt.Sprite(i,[572,1,231,126],{disabled:!0});g=new Tilt.Container({x:77,y:239,
hidden:!0,elements:[W,E,X,Y,Z,ba]});ca=new Tilt.Sprite(i,[210,180,610,510],{disabled:!0});da=new Tilt.Button(null,{width:30,height:30,onclick:function(){a.dismissModal(f)}.bind(this)});f=new Tilt.Container({hidden:!0,background:"#0107",elements:[ca,da]});c.push(k,G,O);d.push(H,p,C,z,J,I,U,V,$,Q,N,L,T,R,S,K,l,m,j,q,t,s,x,r,o,w,u,v,y,A,n,B,D,F);if(TiltChrome.Config.Visualization.hideUserInterfaceAtInit)O.onclick();if(TiltChrome.Config.Visualization.disableMinidomAtInit)h.view.hidden=!0}};this.draw=
function(){a.draw()};this.panelEditorShown=function(){z.hidden=!1;J.hidden=!1;I.hidden=!1};this.panelEditorHidden=function(){z.hidden=!0;J.hidden=!0;I.hidden=!0};this.panelPickerShown=function(){};this.panelPickerHidden=function(){var a=TiltChrome.BrowserOverlay.colorPicker.iframe.contentDocument.colorPicked;this.$colorPickerConfig.fill=a;this.$colorPickerButton.setFill(a);this.meshReadyCallback();this.visualization.performMeshColorbufferRefresh()};this.meshNodeCallback=function(a,c,d,f){if(!TiltChrome.Config.Visualization.disableMinidomAtInit){if(h.$loaded)h.$loaded=
!1,h.view.clear(),this.stripNo=0;if("undefined"===typeof this.stripNo)this.stripNo=0;if(!("undefined"===typeof a.localName||a.localName===null)){var d=this.stripNo++,g=3+c*6,c=3+d*10,i,k,l,m;l=Tilt.Math.clamp(a.localName.length,4,10);var d=Tilt.Math.clamp(a.id.length,4,10),j=Tilt.Math.clamp(a.className.length,4,10),O=g+l*10+3,n=O+d*2+3,g=new Tilt.Button(null,{x:g,y:c,width:l*10,height:7,padding:[-1,-1,-1,-1],stroke:b.domStrips.stripButton.stroke});l=g.getX()+g.getWidth();m=g.getY()+g.getHeight()*
2;a.id&&(i=new Tilt.Button(null,{x:O,y:c,width:d*2,height:7,padding:[-1,-1,-1,-1],stroke:g.getStroke()}),l=Math.max(l,i.getX()+i.getWidth()));a.className&&(k=new Tilt.Button(null,{x:n,y:c,width:j*2,height:7,padding:[-1,-1,-1,-1],stroke:g.getStroke()}),l=Math.max(l,k.getX()+k.getWidth()));l>h.view.getWidth()&&h.view.setWidth(l);h.bottom=m;if(g)h.view.push(g),g.localName=a.localName,g.onclick=function(){a.localName==="img"||a.localName==="input"||a.localName==="button"||a.localName==="meta"||a.localName===
"link"||a.localName==="style"||a.localName==="script"||a.localName==="noscript"?this.visualization.setAttributesEditor():this.visualization.setHtmlEditor();this.visualization.openEditor(f)}.bind(this);if(i)h.view.push(i),i.setFill(g.getFill()),i.localName=a.localName,i.onclick=function(){this.visualization.setAttributesEditor();this.visualization.openEditor(f)}.bind(this);if(k)h.view.push(k),k.setFill(g.getFill()),k.localName=a.localName,k.onclick=function(){this.visualization.setAttributesEditor();
this.visualization.openEditor(f)}.bind(this)}}};this.meshReadyCallback=function(){if(!TiltChrome.Config.Visualization.disableMinidomAtInit)h.view.forEach(function(a){a.setFill((b.domStrips[a.localName!=="head"&&a.localName!=="body"?a.localName:"head/body"]||b.domStrips.other).fill)}),h.$loaded=!0};this.resize=function(a,b){k.setSize(a,b);h.view.setHeight(b-310);G.setX(a-50);H.setX(a-150);p.setX(a-215);C.setX(a-285);z.setX(a-337);J.setX(a-377);I.setX(a-465)};this.destroy=function(v){b=a=this.controller=
this.visualization=null;v&&(c!==null&&(c.destroy(),c=null),d!==null&&(d.destroy(),d=null),f!==null&&(f.destroy(),f=null),g!==null&&(g.destroy(),g=null),h!==null&&(h.destroy(),h=null),i!==null&&(i.destroy(),i=null),k!==null&&(k.destroy(),k=null),da=ca=ba=Z=Y=X=E=K=S=$=V=U=R=T=L=N=Q=O=J=z=I=C=p=H=G=F=D=B=n=A=u=w=o=r=x=s=t=q=j=m=l=null,Tilt.destroyObject(this))};Tilt.Profiler.intercept("TiltChrome.UI",this)};TiltChrome=TiltChrome||{};EXPORTED_SYMBOLS=["TiltChrome.Visualization"];
TiltChrome.Visualization=function(a,b,c){var d=new Tilt.Renderer(a,{onfail:function(){TiltChrome.BrowserOverlay.destroy(!0,!0);TiltChrome.BrowserOverlay.href=null;window.content.location.href="http://get.webgl.org/"},onsuccess:function(){window.setTimeout(function(){if(d&&d.frameCount<1)TiltChrome.BrowserOverlay.destroy(!0,!0),TiltChrome.BrowserOverlay.href=null,window.content.location.href="http://get.webgl.org/troubleshooting/",Tilt.Console.alert("Firefox",Tilt.StringBundle.get("tilt.error"))},
1E3)}}),f=null,g=null,h=15,i=null,k=null,l=null,m={index:-1,fill:"#fff",stroke:"000",strokeWeight:1,v0:vec3.create(),v1:vec3.create(),v2:vec3.create(),v3:vec3.create()},j={offset:vec3.create(),translation:vec3.create(),rotation:quat4.create(),tilt:vec3.create()},q=!0,t=!0,s=!0,x=function(){d&&d.gl&&(TiltChrome.Config.Visualization.reload(),l=new Tilt.Program(TiltChrome.Shaders.Visualization.vs,TiltChrome.Shaders.Visualization.fs),o(),w(),y(),vec3.set([0,0,0],j.offset),vec3.set([0,0,0],j.translation),
quat4.set([0,0,0,1],j.rotation),vec3.set([0,0,0],j.tilt),window.setTimeout(function(){try{G(),H()}catch(a){}}.bind(this),100),window.content.focus())}.bind(this),r=function(){if(d&&d.gl){d.loop(r,!0);t&&(t=!1,u());s&&(s=!1,v());if(q){q=!1;d.clear(0,0,0,1);d.translate(d.width*0.5+100,d.height*0.5-50,-h*30);TiltChrome.Config.Visualization.useAccelerometer&&d.transform(quat4.toMat4(Tilt.Math.quat4fromEuler(0,Tilt.Math.map(j.tilt[0],-1,1,1.57079633,-1.57079633),Tilt.Math.map(j.tilt[2],-1,1,-1.57079633,
1.57079633))));d.translate(j.translation[0],0,j.translation[2]);d.transform(quat4.toMat4(j.rotation));d.translate(0,j.translation[1],0);d.translate(j.offset[0],j.offset[1],0);d.blendMode("alpha");d.strokeWeight(2);i.draw();k.draw();if(m.index!==-1){var a=mat4.multiplyVec4,f=i.mvMatrix;d.perspective();d.depthTest(!1);d.fill(m.fill);d.stroke(m.stroke);d.strokeWeight(m.strokeWeight);d.quad(a(f,m.$v0,m.v0),a(f,m.$v1,m.v1),a(f,m.$v2,m.v2),a(f,m.$v3,m.v3))}c&&"function"===typeof c.draw&&c.draw(d.frameDelta)}b&&
"function"===typeof b.update&&b.update(d.frameDelta);(d.frameCount+1)%1E3===0&&TiltChrome.BrowserOverlay.performGC()}}.bind(this),o=function(){if("undefined"!==typeof b)b.visualization=this,"function"===typeof b.init&&b.init(a)}.bind(this),w=function(){if("undefined"!==typeof c)c.visualization=this,c.controller=b,Tilt.UI.requestRedraw=this.requestRedraw,"function"===typeof c.init&&c.init(a)}.bind(this),u=function(){var a=this.$refreshBoundingClientRect;if("undefined"===typeof a||a===null){if(f=Tilt.WebGL.initDocumentImage(window.content),
g!==null&&g.destroy(),g=new Tilt.Texture(f,{preserve:!0}),i!==null)i.texture=g}else if("object"===typeof a){var b=Tilt.WebGL.refreshDocumentImage(window.content,f,a);b&&g.updateSubImage2D(b,a.left,a.top)}}.bind(this),v=function(){if(d&&d.gl){Tilt.Random.seed(Math.PI);var a=Tilt.Random.next,b=[],f=[],m=[],n=[],p=[],s=[],r=0,t=0;if(i!==null)i.texture=null,i.destroy();k!==null&&k.destroy();Tilt.Document.traverse(function(i,k,l,j,o,q,u,v){c&&"function"===typeof c.meshNodeCallback&&c.meshNodeCallback(i,
k,l,j);var l=d.gl.getParameter(d.gl.MAX_TEXTURE_SIZE),w=i.localName,j={innerHTML:i.innerHTML,attributes:i.attributes,localName:w,className:i.className,id:i.id,uid:j,style:"",index:-1};try{j.style=window.getComputedStyle(i)}catch(x){}if(w==="head"||w==="title"||w==="meta"||w==="link"||w==="style"||w==="script"||w==="noscript"||w==="option"||w==="ins"||w==="del")s.push(j);else{var y=Tilt.Document.getNodeCoordinates(i),w=y.width,i=y.height;w>2&&i>2?(j.index=p.length,p.push(j),j=b.length/3,k=k*h+a()*
0.1,o=y.x+o+a()*0.1,q=y.y+q+a()*0.1,u=Math.min(u,w),v=Math.min(v,i),o>l||q>l||(o+u>l&&(u=Math.max(l-o,0)),q+v>l&&(v=Math.max(l-q,0)),r=Math.max(u,r),t=Math.max(v,t),b.unshift(o,q,k,o+u,q,k,o+u,q+v,k,o,q+v,k,o,q+v,k-h,o+u,q+v,k-h,o+u,q+v,k,o,q+v,k,o,q,k,o+u,q,k,o+u,q,k-h,o,q,k-h),f.unshift(o/g.width,q/g.height,(o+u)/g.width,q/g.height,(o+u)/g.width,(q+v)/g.height,o/g.width,(q+v)/g.height,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1),m.unshift(j+0,j+1,j+2,j+0,j+2,j+3,j+4,j+5,j+6,j+4,j+6,j+7,j+8,
j+9,j+10,j+8,j+10,j+11,j+10,j+9,j+6,j+10,j+6,j+5,j+8,j+11,j+4,j+8,j+4,j+7),n.unshift(j+0,j+1,j+1,j+2,j+2,j+3,j+3,j+0,j+4,j+5,j+5,j+6,j+6,j+7,j+7,j+4,j+8,j+9,j+9,j+10,j+10,j+11,j+11,j+8,j+10,j+9,j+9,j+6,j+6,j+5,j+5,j+10))):s.push(j)}}.bind(this),function(a,b){c&&"undefined"!==c.meshReadyCallback&&c.meshReadyCallback(a,b)}.bind(this),!0);i=new Tilt.Mesh({vertices:new Tilt.VertexBuffer(b,3),texCoord:new Tilt.VertexBuffer(f,2),indices:new Tilt.IndexBuffer(m),tint:[1,1,1,0.85],alpha:1,texture:g,visibleNodes:p,
hiddenNodes:s,draw:function(){var a=Tilt.$renderer,b=this.vertices,c=this.texCoord,d=this.color,f=this.indices,g=this.tint,h=this.alpha,i=this.texture,j=this.drawMode,k=l;k.use();k.bindVertexBuffer("vertexPosition",b);k.bindVertexBuffer("vertexTexCoord",c);k.bindVertexBuffer("vertexColor",d);k.bindUniformMatrix("mvMatrix",a.mvMatrix);k.bindUniformMatrix("projMatrix",a.projMatrix);k.bindUniformVec4("tint",g);k.bindUniformFloat("alpha",h);k.bindTexture("sampler",i);a.drawIndexedVertices(j,f);this.mvMatrix=
mat4.create(a.mvMatrix);this.projMatrix=mat4.create(a.projMatrix)}});k=new Tilt.Mesh({vertices:i.vertices,indices:new Tilt.IndexBuffer(n),color:[0,0,0,0.25],drawMode:d.LINES});r=Math.min(r,window.content.innerWidth);t=Math.min(t,window.content.innerHeight);j.offset[0]=-r*0.5;j.offset[1]=-t*0.5;this.performMeshColorbufferRefresh()}}.bind(this),y=function(){var a=gBrowser.tabContainer,b=gBrowser.contentWindow,c=TiltChrome.BrowserOverlay.sourceEditor.panel,d=TiltChrome.BrowserOverlay.colorPicker.panel;
window.addEventListener("MozAfterPaint",A,!1);window.addEventListener("devicemotion",n,!1);a.addEventListener("TabClose",B,!1);a.addEventListener("TabAttrModified",B,!1);b.addEventListener("blur",D,!1);b.addEventListener("focus",F,!1);b.addEventListener("resize",G,!1);gBrowser.addEventListener("mouseover",H,!1);gBrowser.addEventListener("load",p,!0);c.addEventListener("popupshown",C,!1);c.addEventListener("popuphidden",I,!1);d.addEventListener("popupshown",z,!1);d.addEventListener("popuphidden",J,
!1)}.bind(this),A=function(b){if(!this.$gResizing&&!this.$gFocusing&&!this.$gBlurring){var c=TiltChrome.Config.Visualization,f=b.boundingClientRect,b=f.left,g=f.top,h=f.width,i=f.height,k=a.offsetLeft,j=a.offsetTop;if(!(c.refreshVisualization<=-1))if(c.refreshVisualization>=0&&g>j&&b>k&&h>4&&i>4)this.requestRefreshTexture(f);else if(c.refreshVisualization>=1&&d.frameCount>100)f=window.content.innerWidth,k=window.content.innerHeight,(c.refreshVisualization>=2||b<=0&&g<=0&&(b>=-f||g>=-k)&&(h>=f||i>=
k))&&window.setTimeout(function(){try{!s&&!t&&(this.requestRefreshTexture(null),this.requestRefreshMesh())}catch(a){}}.bind(this),10)}}.bind(this),n=function(a){if(TiltChrome.Config.Visualization.useAccelerometer){var a=a.accelerationIncludingGravity,b=a.x-Math.PI*0.01,c=a.z;j.tilt[0]+=(a.y-Math.PI*0.01-j.tilt[0])*0.5;j.tilt[1]+=(c-j.tilt[1])*0.5;j.tilt[2]+=(b-j.tilt[2])*0.5;this.requestRedraw()}}.bind(this),B=function(){if(TiltChrome.BrowserOverlay.href!==window.content.location.href)TiltChrome.BrowserOverlay.href=
null,TiltChrome.BrowserOverlay.destroy(!0,!0)}.bind(this),D=function(){this.$gBlurring=!0;window.setTimeout(function(){this.$gBlurring=!1}.bind(this),250)}.bind(this),F=function(){this.$gFocusing=!0;window.setTimeout(function(){this.$gFocusing=!1}.bind(this),250)}.bind(this),G=function(){this.$gResizing=!0;this.requestRedraw();d.width=window.content.innerWidth;d.height=window.content.innerHeight;b&&"function"===typeof b.resize&&b.resize(d.width,d.height);c&&"function"===typeof c.resize&&c.resize(d.width,
d.height);try{"open"===TiltChrome.BrowserOverlay.sourceEditor.panel.state&&TiltChrome.BrowserOverlay.sourceEditor.panel.hidePopup(),"open"===TiltChrome.BrowserOverlay.colorPicker.panel.state&&TiltChrome.BrowserOverlay.colorPicker.panel.hidePopup()}catch(a){}}.bind(this),H=function(){window.setTimeout(function(){this.$gResizing=!1}.bind(this),100);this.requestRedraw();d.width=window.content.innerWidth;d.height=window.content.innerHeight;if(a.width!==d.width||a.height!==d.height)a.width=d.width,a.height=
d.height,d.gl.viewport(0,0,a.width,a.height),r()}.bind(this),p=function(){"undefined"===typeof this.$gLoadFinished?this.$gLoadFinished=!0:window.setTimeout(function(){try{!s&&!t&&(this.requestRefreshTexture(null),this.requestRefreshMesh())}catch(a){}}.bind(this),1E3)}.bind(this),C=function(){"function"===typeof c.panelEditorShown&&c.panelEditorShown();this.requestRedraw()}.bind(this),I=function(){"function"===typeof c.panelEditorHidden&&c.panelEditorHidden();m.index=-1;TiltChrome.BrowserOverlay.performGC();
this.requestRedraw()}.bind(this),z=function(){"function"===typeof c.panelPickerShown&&c.panelPickerShown();this.requestRedraw()}.bind(this),J=function(){"function"===typeof c.panelPickerHidden&&c.panelPickerHidden();m.index=-1;TiltChrome.BrowserOverlay.performGC();this.requestRedraw()}.bind(this);this.requestRedraw=function(){q=!0};this.requestRefreshTexture=function(a){this.$refreshBoundingClientRect=a;t=q=!0};this.requestRefreshMesh=function(){s=q=!0};this.performMeshSave=function(a,b){Tilt.File.saveImage(f,
a+Tilt.File.separator+b+".png");i.save(a,b)};this.performMeshColorbufferRefresh=function(){this.requestRedraw();for(var a=TiltChrome.Config.UI.domStrips,b=Tilt.Math.clamp,c=Tilt.Math.hex2rgba,d=Math.floor,f=i.visibleNodes,g=[],h=0,k=i.indices.components.length;h<k;h+=30){var j=f[d(h/30)],j=c((a[j.localName!=="head"&&j.localName!=="body"?j.localName:"head/body"]||a.other).fill),l=[b(j[0]*0.6,0,1),b(j[1]*0.6,0,1),b(j[2]*0.6,0,1)],m=[b(j[0]*1,0,1),b(j[1]*1,0,1),b(j[2]*1,0,1)],j=l[0],n=l[1],l=l[2],o=
m[0],p=m[1],m=m[2];g.unshift(0,0,0,0,0,0,0,0,0,0,0,0,j,n,l,j,n,l,o,p,m,o,p,m,o,p,m,o,p,m,j,n,l,j,n,l)}i.color=new Tilt.VertexBuffer(g,3)};this.performMeshPickHighlight=function(a,b){this.performMeshPick(a,b,{onpick:function(a){"open"===TiltChrome.BrowserOverlay.sourceEditor.panel.state&&TiltChrome.BrowserOverlay.sourceEditor.panel.hidePopup();var b=TiltChrome.Config.UI,c=a[0].node,a=c.index,c=c.localName!=="head"&&c.localName!=="body"?c.localName:"head/body",b=b.domStrips[c]||b.domStrips.other;if(c!==
"html"){m.index=a;m.fill=b.fill+"66";var b=m.index*30,a=i.vertices.components,c=i.indices.components,d=[a[c[b+1]*3],a[c[b+1]*3+1],a[c[b+1]*3+2],1],f=[a[c[b+2]*3],a[c[b+2]*3+1],a[c[b+2]*3+2],1],g=[a[c[b+5]*3],a[c[b+5]*3+1],a[c[b+5]*3+2],1];m.$v0=[a[c[b]*3],a[c[b]*3+1],a[c[b]*3+2],1];m.$v1=d;m.$v2=f;m.$v3=g;this.requestRedraw()}}.bind(this),onfail:function(){"open"===TiltChrome.BrowserOverlay.sourceEditor.panel.state&&TiltChrome.BrowserOverlay.sourceEditor.panel.hidePopup();m.index=-1}})};this.performMeshPickEdit=
function(a,b){this.performMeshPick(a,b,{onpick:function(a){this.openEditor(a[0].node)}.bind(this),onfail:function(){"open"===TiltChrome.BrowserOverlay.sourceEditor.panel.state?TiltChrome.BrowserOverlay.sourceEditor.panel.hidePopup():"open"===TiltChrome.BrowserOverlay.colorPicker.panel.state&&TiltChrome.BrowserOverlay.colorPicker.panel.hidePopup()}})};this.performMeshPick=function(a,b,c){for(var c=c||{},a=Tilt.Math.createRay([a,b,0],[a,b,1],[0,0,d.width,d.height],i.mvMatrix,i.projMatrix),b=[],f=vec3.create(),
g=i.indices.components,h=i.vertices.components,j=0,k=g.length,l,m,n;j<k;j+=3)l=[h[g[j]*3],h[g[j]*3+1],h[g[j]*3+2]],m=[h[g[j+1]*3],h[g[j+1]*3+1],h[g[j+1]*3+2]],n=[h[g[j+2]*3],h[g[j+2]*3+1],h[g[j+2]*3+2]],Tilt.Math.intersectRayTriangle(l,m,n,a,f)>0&&b.push({node:i.visibleNodes[Math.floor(j/30)],location:vec3.create(f)});if(b.length>0){if(b.sort(function(a,b){return a.location[2]<b.location[2]?1:-1}),"function"===typeof c.onpick)c.onpick(b)}else if("function"===typeof c.onfail)c.onfail();this.requestRedraw()};
this.openEditor=function(a){if("number"===typeof a){for(var b=i.visibleNodes,c=i.hiddenNodes,d=0,f=b.length;d<f;d++){var g=b[d];if(a===g.uid){this.openEditor(g);return}}b=0;for(d=c.length;b<d;b++)if(f=c[b],a===f.uid){this.openEditor(f);break}}else if("object"===typeof a){var c=TiltChrome.BrowserOverlay.sourceEditor.panel,b=Tilt.String.trim(style_html(a.innerHTML,{indent_size:2,indent_char:" ",max_char:78,brace_style:"collapse"}))+"\n",d=Tilt.Document.getModifiedCss(a.style),f=Tilt.Document.getAttributesString(a.attributes),
g=document.getElementById("tilt-sourceeditor-title"),h=document.getElementById("tilt-sourceeditor-iframe"),j=h.contentDocument.getElementById("code");g.value="<"+a.localName+(a.className?' class="'+a.className+'"':"")+(a.id?' id="'+a.id+'"':"")+">";c.openPopup(null,"overlap",window.innerWidth-h.width-21,window.innerHeight-h.height-77,!1,!1);j.html=b;j.css=d;j.attr=f;j.theme=TiltChrome.Config.Visualization.sourceEditorTheme;a.localName==="img"||a.localName==="input"||a.localName==="button"||j.editorType===
"attr"?h.contentWindow.refreshCodeEditor("css",j.attr,j.theme):j.editorType==="css"?h.contentWindow.refreshCodeEditor("css",j.css,j.theme):h.contentWindow.refreshCodeEditor("html",j.html,j.theme);b=TiltChrome.Config.UI;c=a.index;a=a.localName!=="head"&&a.localName!=="body"?a.localName:"head/body";b=b.domStrips[a]||b.domStrips.other;if(a!=="html")m.index=c,m.fill=b.fill+"66",a=m.index*30,c=i.vertices.components,b=i.indices.components,d=[c[b[a+1]*3],c[b[a+1]*3+1],c[b[a+1]*3+2],1],f=[c[b[a+2]*3],c[b[a+
2]*3+1],c[b[a+2]*3+2],1],g=[c[b[a+5]*3],c[b[a+5]*3+1],c[b[a+5]*3+2],1],m.$v0=[c[b[a]*3],c[b[a]*3+1],c[b[a]*3+2],1],m.$v1=d,m.$v2=f,m.$v3=g,this.requestRedraw()}};this.setHtmlEditor=function(){var a=document.getElementById("tilt-sourceeditor-iframe"),b=a.contentDocument.getElementById("code");b.editorType="html";a.contentWindow.refreshCodeEditor("html",b.html,b.theme)};this.setCssEditor=function(){var a=document.getElementById("tilt-sourceeditor-iframe"),b=a.contentDocument.getElementById("code");
b.editorType="css";a.contentWindow.refreshCodeEditor("css",b.css,b.theme)};this.setAttributesEditor=function(){var a=document.getElementById("tilt-sourceeditor-iframe"),b=a.contentDocument.getElementById("code");b.editorType="attr";a.contentWindow.refreshCodeEditor("css",b.attr,b.theme)};this.setTranslation=function(a){var b=a[1],c=a[2];if(j.translation[0]!=a[0]||j.translation[1]!=b||j.translation[2]!=c)vec3.set(a,j.translation),this.requestRedraw()};this.setRotation=function(a){var b=a[1],c=a[2],
d=a[3];if(j.rotation[0]!=a[0]||j.rotation[1]!=b||j.rotation[2]!=c||j.rotation[3]!=d)quat4.set(a,j.rotation),this.requestRedraw()};this.setMeshWireframeColor=function(a){k.color=a;this.requestRedraw()};this.setMeshWireframeAlpha=function(a){k.color[3]=a;this.requestRedraw()};this.setMeshColor=function(a){i.tint=a;this.requestRedraw()};this.setMeshAlpha=function(a){i.tint[3]=a;this.requestRedraw()};this.setMeshTextureAlpha=function(a){i.alpha=a;this.requestRedraw()};this.destroy=function(){var O=gBrowser.tabContainer,
Q=gBrowser.contentWindow,N=TiltChrome.BrowserOverlay.sourceEditor.panel,L=TiltChrome.BrowserOverlay.colorPicker.panel;A!==null&&(window.removeEventListener("MozAfterPaint",A,!1),A=null);n!==null&&(window.removeEventListener("devicemotion",n,!1),n=null);B!==null&&(O.removeEventListener("TabClose",B,!1),O.removeEventListener("TabAttrModified",B,!1),B=null);D!==null&&(Q.removeEventListener("blur",D,!1),D=null);F!==null&&(Q.removeEventListener("focus",F,!1),F=null);G!==null&&(Q.removeEventListener("resize",
G,!1),G=null);H!==null&&(gBrowser.removeEventListener("mouseover",H,!1),H=null);p!==null&&(gBrowser.removeEventListener("load",p,!0),p=null);C!==null&&(N.removeEventListener("popupshown",C,!1),C=null);I!==null&&(N.removeEventListener("popuphidden",I,!1),I=null);z!==null&&(L.removeEventListener("popupshown",z,!1),z=null);J!==null&&(L.removeEventListener("popuphidden",J,!1),J=null);b&&"function"===typeof b.destroy&&(b.destroy(a),b=null);c&&"function"===typeof c.destroy&&(c.destroy(a),c=null);g!==null&&
(g.destroy(),g=null);i!==null&&(i.destroy(),i=null);k!==null&&(k.destroy(),k=null);l!==null&&(l.destroy(),l=null);m!==null&&(Tilt.destroyObject(m),m=null);j!==null&&(Tilt.destroyObject(j),j=null);d!==null&&(d.destroy(),d=null);y=v=u=w=o=r=x=s=t=q=j=m=l=k=i=h=g=f=c=b=a=null;Tilt.destroyObject(this)};Tilt.Profiler.intercept("TiltChrome.Visualization",this);x.call(this);r.call(this)};TiltChrome=TiltChrome||{};EXPORTED_SYMBOLS=["TiltChrome.Shaders"];TiltChrome.Shaders={};
TiltChrome.Shaders.Visualization={vs:"attribute vec3 vertexPosition;\nattribute vec2 vertexTexCoord;\nattribute vec3 vertexColor;\nuniform mat4 mvMatrix;\nuniform mat4 projMatrix;\nvarying vec2 texCoord;\nvarying vec3 color;\nvoid main(void) {\n  gl_Position = projMatrix * mvMatrix * vec4(vertexPosition, 1.0);\n  texCoord = vertexTexCoord;\n  color = vertexColor;\n}",fs:"#ifdef GL_ES\nprecision lowp float;\n#endif\nuniform vec4 tint;\nuniform float alpha;\nuniform sampler2D sampler;\nvarying vec2 texCoord;\nvarying vec3 color;\nvoid main(void) {\n  if (texCoord.x < 0.0) {\n    gl_FragColor = vec4(color.r, color.g, color.b, tint.a);\n  }\n  else {\n    vec3 texture = texture2D(sampler, texCoord).rgb;\n    gl_FragColor = tint * alpha * vec4(texture, 1.0) + tint * (1.0 - alpha);\n  }\n}"};
